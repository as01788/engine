{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/2d/assembler/label/ttfUtils.ts"],"names":["Overflow","Label","MAX_SIZE","_BASELINE_OFFSET","_invisibleAlpha","toFixed","_context","_canvas","_texture","_fontDesc","_string","_fontSize","_drawFontsize","_splitStrings","_canvasSize","Size","_lineHeight","_hAlign","_vAlign","_color","Color","_alpha","_fontFamily","_overflow","NONE","_isWrapText","_outlineComp","_outlineColor","BLACK","clone","_shadowComp","_shadowColor","_canvasPadding","Rect","_contentSizeExtend","ZERO","_nodeContentSize","_startPosition","Vec2","_drawUnderlinePos","_drawUnderlineWidth","_underlineThickness","_isBold","_isItalic","_isUnderline","Alignment","ttfUtils","getAssemblerData","sharedLabelData","_canvasPool","get","resetAssemblerData","assemblerData","put","updateRenderData","comp","renderData","vertDirty","trans","node","_uiProps","uiTransformComp","_updateFontFamily","_updateProperties","_calculateLabelFont","_updateLabelDimensions","_updateTexture","updateOpacity","_calDynamicAtlas","actualFontSize","setContentSize","updateVertexData","updateUvs","markForUpdateRenderData","spriteFrame","vData","colorOffset","colorA","opacity","i","useSystemFont","font","_nativeAsset","fontFamily","context","canvas","string","toString","fontSize","overflow","width","height","underlineHeight","lineHeight","horizontalAlign","verticalAlign","color","isBold","isItalic","isUnderline","RESIZE_HEIGHT","enableWrapText","LabelOutline","getComponent","enabled","set","LabelShadow","_updatePaddingRect","top","bottom","left","right","outlineWidth","shadowWidth","blur","offsetX","offset","x","offsetY","y","Math","max","tan","_calculateFillTextStartPosition","labelX","HorizontalTextAlignment","RIGHT","CENTER","_getLineHeight","drawStartY","length","firstLinelabelY","BASELINE_RATIO","VerticalTextAlignment","TOP","blank","BOTTOM","clearRect","lineJoin","fillStyle","r","g","b","fillRect","_srcBlendFactor","BlendFactor","SRC_ALPHA","drawTextPosX","drawTextPosY","_drawTextEffect","strokeText","fillText","shadowColor","_uploadTexture","cacheMode","CacheMode","BITMAP","frame","ttfSpriteFrame","dynamicAtlasManager","deleteAtlasSpriteFrame","_resetDynamicAtlasFrame","tex","SpriteFrame","texture","uploadAgain","reset","mipmapLevel","uploadData","rect","_calculateUV","textureDirty","legacyCC","director","root","batcher2D","_releaseDescriptorSetCache","getHash","packToDynamicAtlas","uvDirty","_setupOutline","strokeStyle","a","lineWidth","_setupShadow","shadowBlur","shadowOffsetX","shadowOffsetY","startPosition","isMultiple","measureText","_measureText","min","recreate","textAlign","textBaseline","_getFontDesc","fontDesc","nodeSpacingY","_calculateParagraphLength","paragraphedStrings","ctx","paragraphLength","para","push","_calculateShrinkFont","totalHeight","maxLength","canvasWidthNoMargin","canvasHeightNoMargin","textFragment","mid","allWidth","scaleX","scaleY","_calculateWrapText","concat","split","canvasSizeX","canvasSizeY","paraLength","rawWidth","parseFloat","rawHeight","SHRINK","CLAMP"],"mappings":"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"}
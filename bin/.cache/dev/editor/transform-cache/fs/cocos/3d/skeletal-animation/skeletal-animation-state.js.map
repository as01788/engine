{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/3d/skeletal-animation/skeletal-animation-state.ts"],"names":["m4_1","Mat4","m4_2","SkeletalAnimationState","AnimationState","constructor","clip","name","_frames","_bakedDuration","_animInfo","_sockets","_animInfoMgr","_comps","_parent","_curvesInited","legacyCC","director","root","dataPoolManager","jointAnimationInfo","initialize","_curveLoaded","length","comps","getComponentsInChildren","SkinnedMeshRenderer","i","comp","skinningRoot","push","getComponent","baked","useBakedAnimation","_doNotCreateEval","frames","samples","SkelAnimDataHub","getOrExtract","getData","uuid","onPlay","_sampleCurves","_sampleCurvesBaked","duration","switchClip","uploadAnimation","_targetNode","rebuildSocketCurves","sockets","socket","targetNode","getChildByPath","path","target","clipData","animPath","source","joints","animNode","downstream","idx","lastIndexOf","substring","identity","fromRTS","rotation","position","scale","multiply","parent","curveData","transforms","f","mat","tfm","pos","Vec3","rot","Quat","toRTS","_setAnimInfoDirty","info","value","dirty","JSB","key","fill","time","ratio","curFrame","data","setRTS"],"mappings":"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"}
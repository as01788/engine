{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/3d/skeletal-animation/skeletal-animation-utils.ts"],"names":["uploadJointData","uploadJointDataLBS","MINIMUM_JOINT_TEXTURE_SIZE","EDITOR","selectJointsMediumFormat","device","hasFeature","Feature","TEXTURE_FLOAT","Format","RGBA32F","RGBA8","out","base","mat","firstBone","m00","m01","m02","m12","m04","m05","m06","m13","m08","m09","m10","m14","dq_0","Quat","dq_1","v3_1","Vec3","qt_1","v3_2","uploadJointDataDQS","Mat4","toRTS","copy","dot","multiplyScalar","set","x","y","z","multiply","w","roundUpTextureSize","targetLength","formatSize","formatScale","Math","sqrt","ceil","max","jointTextureSamplerInfo","SamplerInfo","Filter","POINT","NONE","Address","CLAMP","v3_3","v3_4","v3_min","v3_max","m4_1","m4_2","ab_1","AABB","Inf","Number","MAX_SAFE_INTEGER","JointTexturePool","pixelsPerJoint","_pixelsPerJoint","constructor","_device","_pool","_textureBuffers","Map","_formatSize","_customPool","_chunkIdxMap","format","FormatInfos","size","TextureBufferPool","initialize","roundUpFn","clear","destroy","registerCustomTextureLayouts","layouts","i","length","layout","chunkIdx","createChunk","textureLength","j","contents","content","skeleton","k","clips","clip","getDefaultPoseTexture","mesh","skinningRoot","hash","texture","get","bounds","has","refCount","joints","bindposes","textureBuffer","buildTexture","jointCount","bufSize","customChunkIdx","handle","undefined","alloc","Float32Array","BYTES_PER_ELEMENT","pixelOffset","start","skeletonHash","clipHash","readyToBeDeleted","boneSpaceBounds","getBoneSpaceBounds","offset","node","getChildByPath","inverseBindposes","bound","transform","getBoundary","min","IDENTITY","fromPoints","update","buffer","getSequencePoseTexture","clipData","SkelAnimDataHub","getOrExtract","frames","animInfos","_createAnimInfos","f","push","curveData","downstream","bindposeIdx","bindposeCorrection","transformValid","boneSpaceBound","center","halfExtents","releaseHandle","free","delete","releaseSkeleton","it","values","res","next","done","value","releaseAnimationClip","animPath","source","animNode","correctionPath","idx","lastIndexOf","substring","fromRTS","rotation","position","scale","parent","t","transforms","JointAnimationInfo","getData","nodeID","createBuffer","BufferInfo","BufferUsageBit","UNIFORM","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","UBOSkinningAnimation","SIZE","data","info","dirty","_setAnimInfoDirty","JSB","key","convertVal","Object","defineProperty","Uint32Array","fill","enumerable","switchClip"],"mappings":"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"}
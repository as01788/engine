{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/particle/renderer/particle-system-renderer-cpu.ts"],"names":["_tempAttribUV","Vec3","_tempWorldTrans","Mat4","_node_rot","Quat","_node_euler","_anim_module","_uvs","CC_USE_WORLD_SPACE","CC_RENDER_MODE","ROTATION_OVER_TIME_MODULE_ENABLE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","_vertex_attrs","Attribute","AttributeName","ATTR_POSITION","Format","RGB32F","ATTR_TEX_COORD","ATTR_TEX_COORD1","ATTR_TEX_COORD2","ATTR_COLOR","RGBA8","_vertex_attrs_stretch","ATTR_COLOR1","_vertex_attrs_mesh","ATTR_TEX_COORD3","ATTR_NORMAL","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererCPU","ParticleSystemRendererBase","constructor","info","_defines","_trailDefines","_frameTile_velLenScale","_tmp_velLenScale","_defaultMat","_node_scale","_attrs","_particles","_defaultTrailMat","_updateList","Map","_animateList","_runAnimateList","Array","_fillDataFunc","_uScaleHandle","_uLenHandle","_uNodeRotHandle","_alignSpace","AlignmentSpace","View","_inited","_localMat","_gravity","Vec4","_model","clone","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","onInit","ps","RecyclePool","Particle","_setVertexAttrib","_setFillFunc","_initModuleList","_initModel","updateMaterialParams","updateTrailMaterial","setVertexAttributes","clear","reset","_particleSystem","_trailModule","updateRenderData","enabled","updateRenderMode","getFreeParticle","length","capacity","add","getDefaultTrailMaterial","setNewParticle","p","forEach","val","pm","enable","needUpdate","name","needAnimate","i","len","PARTICLE_MODULE_ORDER","push","enableModule","updateAlignSpace","space","updateRotation","mat","getMaterialInstance","pass","passes","doUpdateRotation","Local","node","getRotation","World","getWorldRotation","set","cameraLst","scene","renderScene","cameras","undefined","camera","checkCamera","EDITOR","visibility","layer","fromViewUp","forward","setUniform","updateScale","doUpdateScale","scaleSpace","Space","getScale","getWorldScale","updateParticles","dt","getWorldMatrix","value","key","update","_simulationSpace","trailModule","trailEnable","simulationSpace","r","fromQuat","transpose","data","remainingLifetime","animatedVelocity","removeParticle","removeAt","gravityFactor","gravityModifier","evaluate","startLifetime","randomSeed","x","y","z","w","transformMat4","velocity","copy","ultimateVelocity","animate","scaleAndAdd","position","idx","fi","textureModule","_textureAnimationModule","frameIndex","beforeRender","updateIA","getParticleCount","onMaterialModified","index","material","onRebuildPSO","setSubModelMaterial","_trailModel","_renderInfo","renderMode","RenderMode","Mesh","_fillMeshData","StrecthedBillboard","_fillStrecthedData","_fillNormalData","size","rotation","color","_val","addParticleVertexData","j","_vertAttrs","slice","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","builtinResMgr","get","MaterialInstance","setProperty","getHandle","vlenScale","Billboard","velocityScale","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","Vec2","numTilesX","numTilesY","roationModule","_rotationOvertimeModule","recompileShaders","updateMaterial"],"mappings":"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"}
{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/particle/renderer/particle-system-renderer-gpu.ts"],"names":["_tempWorldTrans","Mat4","_tempVec4","Vec4","_world_rot","Quat","_node_rot","_node_euler","Vec3","_sample_num","_sample_interval","CC_USE_WORLD_SPACE","CC_RENDER_MODE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","COLOR_OVER_TIME_MODULE_ENABLE","ROTATION_OVER_TIME_MODULE_ENABLE","SIZE_OVER_TIME_MODULE_ENABLE","VELOCITY_OVER_TIME_MODULE_ENABLE","FORCE_OVER_TIME_MODULE_ENABLE","TEXTURE_ANIMATION_MODULE_ENABLE","_vert_attr_name","POSITION_STARTTIME","VERT_SIZE_UV","VERT_ROTATION_UV","COLOR","DIR_LIFE","RANDOM_SEED","_gpu_vert_attr","Attribute","Format","RGBA32F","R32F","_gpu_vert_attr_mesh","AttributeName","ATTR_TEX_COORD","RGB32F","ATTR_TEX_COORD3","ATTR_NORMAL","ATTR_COLOR1","RGBA8","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererGPU","ParticleSystemRendererBase","constructor","info","_defines","_frameTile_velLenScale","_unifrom_velLenScale","_tmp_velLenScale","_node_scale","_vertAttrs","_defaultMat","_particleNum","_tempParticle","_colorTexture","_forceTexture","_velocityTexture","_rotationTexture","_sizeTexture","_animTexture","_uTimeHandle","_uRotHandle","_uNodeRotHandle","_alignSpace","AlignmentSpace","View","_inited","clone","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","Particle","onInit","ps","_setVertexAttrib","_initModel","updateMaterialParams","setVertexAttributes","updateRenderMode","_model","constructAttributeIndex","clear","updateRenderData","onDestroy","destroy","enableModule","name","val","pm","mat","_particleSystem","getMaterialInstance","initShaderUniform","recompileShaders","setSubModelMaterial","getFreeParticle","_capacity","setNewParticle","p","addGPUParticleVertexData","_time","updateRotation","pass","passes","doUpdateRotation","Local","node","getRotation","World","getWorldRotation","set","cameraLst","scene","renderScene","cameras","undefined","i","length","camera","checkCamera","EDITOR","visibility","layer","fromViewUp","forward","setUniform","updateScale","doUpdateScale","scaleSpace","Space","getScale","getWorldScale","getHandle","updateParticles","dt","getWorldMatrix","updateGPUParticles","updateShaderUniform","enabled","beforeRender","updateIA","updateAlignSpace","space","x","y","enable","forceModule","_forceOvertimeModule","z","handle","binding","Pass","getBindingFromHandle","bindSampler","getGFXSampler","bindTexture","getGFXTexture","spaceHandle","modeHandle","height","velocityModule","_velocityOvertimeModule","speedModifier","colorModule","_colorOverLifetimeModule","color","roationModule","_rotationOvertimeModule","separateAxes","sizeModule","_sizeOvertimeModule","size","textureModule","_textureAnimationModule","startFrame","frameOverTime","infoHandle","numTilesX","numTilesY","cycleCount","getParticleCount","onMaterialModified","index","material","onRebuildPSO","_renderInfo","renderMode","RenderMode","StrecthedBillboard","slice","Mesh","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","builtinResMgr","get","MaterialInstance","setProperty","_simulationSpace","Billboard","velocityScale","w","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","Vec2","copy","updateMaterial"],"mappings":"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"}
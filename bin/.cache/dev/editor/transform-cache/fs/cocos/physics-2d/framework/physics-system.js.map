{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/physics-2d/framework/physics-system.ts"],"names":["instance","PhysicsSystem2D","System","enable","_enable","value","allowSleep","_allowSleep","v","EDITOR","physicsWorld","setAllowSleep","gravity","_gravity","set","setGravity","Vec2","x","PHYSICS_2D_PTM_RATIO","y","maxSubSteps","_maxSubSteps","fixedTimeStep","_fixedTimeStep","autoSimulation","_autoSimulation","debugDrawFlags","PHYSICS_NONE","physicsEngineId","PHYSICS_BUILTIN","PHYSICS_BOX2D","PhysicsGroup","stepping","_steping","constructor","velocityIterations","positionIterations","collisionMatrix","CollisionMatrix","_accumulator","_delayEvents","config","game","physics","copy","multiplyScalar","i","bit","parseInt","collisionGroups","cg","Array","forEach","name","index","Enum","update","postUpdate","deltaTime","director","emit","Director","EVENT_BEFORE_PHYSICS","substepIndex","step","events","l","length","event","func","call","target","syncPhysicsToScene","drawDebug","EVENT_AFTER_PHYSICS","_callAfterStep","push","resetAccumulator","time","raycast","p1","p2","type","ERaycast2DType","Closest","mask","testPoint","p","testAABB","rect","ID","once","EVENT_INIT","initPhysicsSystem","registerSystem","Priority","LOW"],"mappings":"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"}
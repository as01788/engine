{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/pipeline/deferred/gbuffer-stage.ts"],"names":["colors","Color","GbufferStage","RenderQueueDesc","RenderStage","constructor","_renderQueues","_renderArea","Rect","_batchedQueue","_instancedQueue","_phaseID","RenderBatchedQueue","RenderInstancedQueue","initialize","info","renderQueues","activate","pipeline","flow","i","length","destroy","render","camera","clear","_pipeline","device","forEach","renderQueueClearFunc","generateRenderArea","updateQuadVertexData","window","renderObjects","pipelineSceneData","m","p","k","ro","subModels","model","subModel","passes","pass","phase","batchingScheme","BatchingSchemes","INSTANCING","instancedBuffer","getInstancedBuffer","merge","instancedAttributes","queue","add","VB_MERGING","batchedBuffer","getBatchedBuffer","insertRenderPass","renderQueueSortFunc","cmdBuff","commandBuffers","uploadBuffers","clearFlag","ClearFlagBit","COLOR","isHDR","clearColor","x","y","z","w","deferredData","getPipelineRenderData","framebuffer","gbufferFrameBuffer","renderPass","beginRenderPass","clearDepth","clearStencil","setScissor","generateScissor","setViewport","generateViewport","bindDescriptorSet","SetIndex","GLOBAL","descriptorSet","recordCommandBuffer","endRenderPass","initInfo","name","priority","DeferredStagePriority","GBUFFER","tag","isTransparent","sortMode","RenderQueueSortMode","FRONT_TO_BACK","stages","BACK_TO_FRONT","serializable"],"mappings":"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"}
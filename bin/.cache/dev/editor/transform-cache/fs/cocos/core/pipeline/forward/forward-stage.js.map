{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/pipeline/forward/forward-stage.ts"],"names":["colors","Color","ForwardStage","RenderQueueDesc","RenderStage","constructor","_renderQueues","_renderArea","Rect","_batchedQueue","_instancedQueue","_phaseID","_clearFlag","RenderBatchedQueue","RenderInstancedQueue","_uiPhase","UIPhase","initialize","info","renderQueues","activate","pipeline","flow","i","length","_additiveLightQueue","RenderAdditiveLightQueue","_pipeline","_planarQueue","PlanarShadowQueue","destroy","render","camera","clear","device","forEach","renderQueueClearFunc","renderObjects","pipelineSceneData","m","p","k","ro","subModels","model","subModel","passes","pass","phase","batchingScheme","BatchingSchemes","INSTANCING","instancedBuffer","getInstancedBuffer","merge","instancedAttributes","queue","add","VB_MERGING","batchedBuffer","getBatchedBuffer","insertRenderPass","renderQueueSortFunc","cmdBuff","commandBuffers","pipelineUBO","updateShadowUBO","uploadBuffers","gatherLightPasses","gatherShadowPasses","clearFlag","ClearFlagBit","COLOR","x","clearColor","y","z","w","generateRenderArea","swapchain","window","framebuffer","renderPass","getRenderPass","beginRenderPass","clearDepth","clearStencil","bindDescriptorSet","SetIndex","GLOBAL","descriptorSet","recordCommandBuffer","profiler","endRenderPass","initInfo","name","priority","ForwardStagePriority","FORWARD","tag","isTransparent","sortMode","RenderQueueSortMode","FRONT_TO_BACK","stages","BACK_TO_FRONT","serializable"],"mappings":"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"}
{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/renderer/scene/skybox.ts"],"names":["skybox_mesh","skybox_material","Skybox","model","_model","enabled","_enabled","val","_setEnabled","activate","_updatePipeline","useHDR","_useHDR","_setUseHDR","setEnvMaps","_envmapHDR","_envmapLDR","useIBL","_useIBL","_setUseIBL","useDiffuseMap","_useDiffuseMap","_updateGlobalBinding","isRGBE","envmap","isHDR","legacyCC","director","root","pipeline","pipelineSceneData","diffuseMap","_diffuseMapHDR","_diffuseMapLDR","setDiffuseMaps","native","_nativeObj","constructor","_globalDSManager","_default","JSB","NaitveSkybox","_setUseDiffuseMap","initialize","skyboxInfo","applyDiffuseMap","envmapHDR","envmapLDR","ambient","groundAlbedo","w","mipmapLevel","diffuseMapHDR","diffuseMapLDR","globalDSManager","builtinResMgr","get","createModel","renderer","scene","Model","_initLocalDescriptors","_initWorldBoundDescriptors","mat","Material","effectName","defines","USE_RGBE_CUBEMAP","MaterialInstance","parent","utils","createMesh","primitives","box","width","height","length","initSubModel","renderingSubMeshes","recompileShaders","setSubModelMaterial","useIBLValue","useDiffuseMapValue","useHDRValue","macros","CC_USE_IBL","CC_USE_DIFFUSEMAP","CC_USE_HDR","onGlobalPipelineStateChanged","device","texture","getGFXTexture","sampler","getSampler","getSamplerInfo","bindSampler","UNIFORM_ENVIRONMENT_BINDING","bindTexture","UNIFORM_DIFFUSEMAP_BINDING","update","_destroy","destroy"],"mappings":"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"}
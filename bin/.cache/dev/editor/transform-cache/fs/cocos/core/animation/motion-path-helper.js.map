{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/animation/motion-path-helper.ts"],"names":["Curve","constructor","points","beziers","ratios","progresses","length","computeBeziers","i","startPoint","endPoint","bezier","Bezier","start","pos","startCtrlPoint","out","end","endCtrlPoint","in","push","getLength","current","Vec2","__arcLengthDivisions","cacheArcLengths","getPointAt","u","t","getUtoTmapping","getPoint","x","y","lengths","getLengths","divisions","cache","last","vector","p","sum","distance","arcLengths","il","targetArcLength","low","high","comparison","Math","floor","lengthBefore","lengthAfter","segmentLength","segmentFraction","checkMotionPath","motionPath","Array","isArray","l","controls","sampleMotionPaths","motionPaths","data","duration","fps","createControlPoints","array","ZERO","values","map","value","Vec3","motionPathValid","undefined","types","ratioSampler","newValues","newTypes","newRatios","addNewDatas","type","ratio","startRatioOffset","EPSILON","newType","AnimCurve","Linear","nextRatio","betweenRatio","nextValue","results","progress","speed","finalProgress","j","l2","controlPoints","curve","normal","subtract","normalize","multiplyScalar","set","add","bezierIndex","lerp","newRatio","abs"],"mappings":"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"}
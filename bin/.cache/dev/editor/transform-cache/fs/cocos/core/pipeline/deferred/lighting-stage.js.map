{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/pipeline/deferred/lighting-stage.ts"],"names":["colors","Color","LightingStage","Material","RenderQueueDesc","RenderStage","constructor","_deferredLitsBufs","_maxDeferredLights","UBODeferredLight","LIGHTS_PER_PASS","_lightMeterScale","_descriptorSet","_renderArea","Rect","_uiPhase","_phaseID","_renderQueues","UIPhase","initialize","info","gatherLights","camera","pipeline","_pipeline","cmdBuff","commandBuffers","sphereLights","scene","spotLights","_sphere","Sphere","create","_vec4Array","Float32Array","exposure","idx","elementLen","Vec4","length","fieldLen","i","light","set","position","x","y","z","range","intersect","sphereFrustum","frustum","Vec3","toArray","_lightBufferData","color","useColorTemperature","tempRGB","colorTemperatureRGB","pipelineSceneData","isHDR","luminance","size","spotAngle","direction","offset","updateBuffer","activate","flow","device","renderQueues","totalSize","BYTES_PER_ELEMENT","Math","ceil","capabilities","uboOffsetAlignment","createBuffer","BufferInfo","BufferUsageBit","UNIFORM","TRANSFER_DST","MemoryUsageBit","HOST","DEVICE","deferredLitsBufView","BufferViewInfo","layoutInfo","DescriptorSetLayoutInfo","localDescriptorSetLayout","bindings","_descriptorSetLayout","createDescriptorSetLayout","createDescriptorSet","DescriptorSetInfo","bindBuffer","UBOForwardLight","BINDING","_planarQueue","PlanarShadowQueue","_deferredMaterial","deferredLightingMaterial","destroy","render","sceneData","renderObjects","update","gatherShadowPasses","dynamicOffsets","bindDescriptorSet","SetIndex","LOCAL","generateRenderArea","clearFlag","ClearFlagBit","COLOR","clearColor","w","deferredData","getPipelineRenderData","framebuffer","outputFrameBuffer","renderPass","pipelineUBO","updateShadowUBO","beginRenderPass","clearDepth","clearStencil","setScissor","generateScissor","setViewport","generateViewport","GLOBAL","descriptorSet","lightingMat","pass","passes","shader","getShaderVariant","bindTexture","gbufferRenderTargets","bindSampler","sampler","MATERIAL","inputAssembler","quadIAOffscreen","pso","PipelineStateManager","getOrCreatePipelineState","bindPipelineState","bindInputAssembler","draw","forEach","renderQueueClearFunc","m","p","k","ro","subModels","model","subModel","phase","insertRenderPass","renderQueueSortFunc","recordCommandBuffer","endRenderPass","initInfo","name","priority","DeferredStagePriority","LIGHTING","tag","serializable"],"mappings":"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"}
{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/asset-manager/utilities.ts"],"names":["defaultProgressCallback","setDefaultProgressCallback","onProgress","clear","task","clearRef","i","l","input","length","item","isNative","content","Asset","decRef","recycle","urlAppendTimestamp","url","append","test","Date","now","retry","process","times","wait","onComplete","index","err","result","setTimeout","getDepends","uuid","data","exclude","depends","config","info","dependUtil","parse","deps","dep","push","bundle","name","nativeDep","e","message","stack","cache","id","asset","cacheAsset","undefined","legacyCC","assetManager","isDefault","assets","add","setProperties","assetsMap","missingAsset","dependMap","get","missingAssetReporter","depend","dependAsset","EDITOR","EditorExtends","MissingReporter","object","stashByOwner","owner","prop","serialize","asAsset","type","placeHolder","initDefault","addRef","reference","references","WeakRef","reportByOwner","delete","nativeDependMap","has","_nativeAsset","console","error","gatherAsset","source","options","__outputAsArray__","output","forEach","array","count","errs","cb","parseParameters","optionsOut","onProgressOut","onCompleteOut","isCallback","Object","create","parseLoadResArgs","typeOut","isValidType","js","isChildClassOf","checkCircleReference","map","checked","getDeps","asyncify","p1","p2","refs","Array","isArray","x"],"mappings":";;;;;;;;;;;;;;;;;;;AA4BA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AAEA;;AAEA;;;;AAxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AAgBA,IAAIA,uBAAgD,GAAG,IAAvD;;AAMO,SAASC,0BAAT,CAAqCC,UAArC,EAAmE;AACtEF,EAAAA,uBAAuB,GAAGE,UAA1B;AACH;;AAEM,SAASC,KAAT,CAAgBC,IAAhB,EAA4BC,QAA5B,EAA+C;AAClD,OAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGH,IAAI,CAACI,KAAL,CAAWC,MAA/B,EAAuCH,CAAC,GAAGC,CAA3C,EAA8CD,CAAC,EAA/C,EAAmD;AAC/C,UAAMI,IAAI,GAAGN,IAAI,CAACI,KAAL,CAAWF,CAAX,CAAb;;AACA,QAAID,QAAJ,EAAc;AACV,UAAI,CAACK,IAAI,CAACC,QAAN,IAAkBD,IAAI,CAACE,OAAL,YAAwBC,YAA9C,EAAqD;AACjDH,QAAAA,IAAI,CAACE,OAAL,CAAaE,MAAb,CAAoB,KAApB;AACH;AACJ;;AACDJ,IAAAA,IAAI,CAACK,OAAL;AACH;;AACDX,EAAAA,IAAI,CAACI,KAAL,GAAa,IAAb;AACH;;AAEM,SAASQ,kBAAT,CAA6BC,GAA7B,EAA0CC,MAA1C,EAAmE;AACtE,MAAIA,MAAJ,EAAY;AACR,QAAI,KAAKC,IAAL,CAAUF,GAAV,CAAJ,EAAoB;AAChB,aAAQ,GAAEA,GAAI,OAAMG,IAAI,CAACC,GAAL,EAAW,EAA/B;AACH;;AAED,WAAQ,GAAEJ,GAAI,OAAMG,IAAI,CAACC,GAAL,EAAW,EAA/B;AACH;;AACD,SAAOJ,GAAP;AACH;;AAIM,SAASK,KAAT,CAAgBC,OAAhB,EAAwCC,KAAxC,EAAuDC,IAAvD,EAAqEC,UAArE,EAAmGC,KAAK,GAAG,CAA3G,EAA8G;AACjHJ,EAAAA,OAAO,CAACI,KAAD,EAAQ,CAACC,GAAD,EAAMC,MAAN,KAAiB;AAC5BF,IAAAA,KAAK;;AACL,QAAI,CAACC,GAAD,IAAQD,KAAK,GAAGH,KAApB,EAA2B;AACvB,UAAIE,UAAJ,EAAgB;AACZA,QAAAA,UAAU,CAACE,GAAD,EAAMC,MAAN,CAAV;AACH;AACJ,KAJD,MAIO;AACHC,MAAAA,UAAU,CAAC,MAAM;AACbR,QAAAA,KAAK,CAACC,OAAD,EAAUC,KAAV,EAAiBC,IAAjB,EAAuBC,UAAvB,EAAmCC,KAAnC,CAAL;AACH,OAFS,EAEPF,IAFO,CAAV;AAGH;AACJ,GAXM,CAAP;AAYH;;AAEM,SAASM,UAAT,CAAqBC,IAArB,EAAmCC,IAAnC,EAAsEC,OAAtE,EACHC,OADG,EACaC,MADb,EACmC;AACtC,MAAI;AACA,UAAMC,IAAI,GAAGC,oBAAWC,KAAX,CAAiBP,IAAjB,EAAuBC,IAAvB,CAAb;;AACA,SAAK,IAAI3B,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAG8B,IAAI,CAACG,IAAL,CAAU/B,MAA9B,EAAsCH,CAAC,GAAGC,CAA1C,EAA6CD,CAAC,EAA9C,EAAkD;AAC9C,YAAMmC,GAAG,GAAGJ,IAAI,CAACG,IAAL,CAAUlC,CAAV,CAAZ;;AACA,UAAI,EAAEmC,GAAG,IAAIP,OAAT,CAAJ,EAAuB;AACnBA,QAAAA,OAAO,CAACO,GAAD,CAAP,GAAe,IAAf;AACAN,QAAAA,OAAO,CAACO,IAAR,CAAa;AAAEV,UAAAA,IAAI,EAAES,GAAR;AAAaE,UAAAA,MAAM,EAAEP,MAAM,IAAIA,MAAM,CAACQ;AAAtC,SAAb;AACH;AACJ;;AACD,QAAIP,IAAI,CAACQ,SAAT,EAAoB;AAChB,UAAIT,MAAJ,EAAY;AACRC,QAAAA,IAAI,CAACQ,SAAL,CAAeF,MAAf,GAAwBP,MAAM,CAACQ,IAA/B;AACH;;AACDT,MAAAA,OAAO,CAACO,IAAR,CAAa,EAAE,GAAGL,IAAI,CAACQ;AAAV,OAAb;AACH;AACJ,GAfD,CAeE,OAAOC,CAAP,EAAU;AACR,sBAAMA,CAAC,CAACC,OAAR,EAAiBD,CAAC,CAACE,KAAnB;AACH;AACJ;;AAEM,SAASC,KAAT,CAAgBC,EAAhB,EAA4BC,KAA5B,EAA0CC,UAA1C,EAAgE;AACnE,MAAI,CAACD,KAAL,EAAY;AAAE;AAAS;;AACvBC,EAAAA,UAAU,GAAGA,UAAU,KAAKC,SAAf,GAA2BD,UAA3B,GAAwCE,wBAASC,YAAT,CAAsBH,UAA3E;;AACA,MAAI,CAAC,qBAAQD,KAAR,CAAD,IAAmBC,UAAnB,IAAiC,CAACD,KAAK,CAACK,SAA5C,EAAuD;AACnDC,mBAAOC,GAAP,CAAWR,EAAX,EAAeC,KAAf;AACH;AACJ;;AAEM,SAASQ,aAAT,CAAwB3B,IAAxB,EAAsCmB,KAAtC,EAAoDS,SAApD,EAAoF;AACvF,MAAIC,YAAY,GAAG,KAAnB;;AACA,QAAM1B,OAAO,GAAG2B,sBAAUC,GAAV,CAAcZ,KAAd,CAAhB;;AACA,MAAIhB,OAAJ,EAAa;AACT,QAAI6B,oBAAyB,GAAG,IAAhC;;AACA,SAAK,IAAI1D,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAG4B,OAAO,CAAC1B,MAA5B,EAAoCH,CAAC,GAAGC,CAAxC,EAA2CD,CAAC,EAA5C,EAAgD;AAC5C,YAAM2D,MAAM,GAAG9B,OAAO,CAAC7B,CAAD,CAAtB;AACA,YAAM4D,WAAW,GAAGN,SAAS,CAAE,GAAEK,MAAM,CAACjC,IAAK,SAAhB,CAA7B;;AACA,UAAI,CAACkC,WAAL,EAAkB;AACd,YAAIC,6BAAJ,EAAY;AACR,cAAI,CAACH,oBAAL,EAA2B;AACvB;AACAA,YAAAA,oBAAoB,GAAG,IAAII,aAAa,CAACC,eAAd,CAA8BC,MAAlC,CAAyCnB,KAAzC,CAAvB;AACH;;AACDa,UAAAA,oBAAoB,CAACO,YAArB,CAAkCN,MAAM,CAACO,KAAzC,EAAgDP,MAAM,CAACQ,IAAvD,EAA6DL,aAAa,CAACM,SAAd,CAAwBC,OAAxB,CAAgCV,MAAM,CAACjC,IAAvC,CAA7D;AACH,SAND,MAMO;AACH,4BAAO,aAAYiC,MAAM,CAACjC,IAAK,cAA/B;AACH;;AACD,YAAIiC,MAAM,CAACW,IAAP,IAAeX,MAAM,CAACW,IAAP,KAAgB/D,YAAnC,EAA0C;AACtC;AACA,gBAAMgE,WAAW,GAAG,IAAIZ,MAAM,CAACW,IAAX,EAApB;AACAC,UAAAA,WAAW,CAACC,WAAZ,CAAwBb,MAAM,CAACjC,IAA/B;AACAiC,UAAAA,MAAM,CAACO,KAAP,CAAaP,MAAM,CAACQ,IAApB,IAA4BI,WAA5B;AACH;;AACDhB,QAAAA,YAAY,GAAG,IAAf;AACH,OAjBD,MAiBO;AACHI,QAAAA,MAAM,CAACO,KAAP,CAAaP,MAAM,CAACQ,IAApB,IAA4BP,WAAW,CAACa,MAAZ,EAA5B;;AACA,YAAIZ,6BAAJ,EAAY;AACR,cAAIa,SAAS,GAAGC,mBAAYlB,GAAZ,CAAgBG,WAAhB,CAAhB;;AACA,cAAI,CAACc,SAAD,IAAc,qBAAQ7B,KAAR,CAAlB,EAAkC;AAC9B6B,YAAAA,SAAS,GAAG,EAAZ;;AACAC,+BAAYvB,GAAZ,CAAgBO,MAAM,CAACjC,IAAvB,EAA6BgD,SAA7B;AACH;;AACDA,UAAAA,SAAS,CAACtC,IAAV,CAAe,CAAC,IAAIwC,OAAJ,CAAY/B,KAAZ,CAAD,EAAqB,IAAI+B,OAAJ,CAAYjB,MAAM,CAACO,KAAnB,CAArB,EAAgDP,MAAM,CAACQ,IAAvD,CAAf;AACH;AACJ;AACJ;;AAED,QAAIT,oBAAJ,EAA0B;AACtBA,MAAAA,oBAAoB,CAACmB,aAArB;AACH;;AACDrB,0BAAUsB,MAAV,CAAiBjC,KAAjB;AACH;;AAED,MAAIkC,4BAAgBC,GAAhB,CAAoBnC,KAApB,CAAJ,EAAgC;AAC5B,QAAIS,SAAS,CAAE,GAAE5B,IAAK,SAAT,CAAb,EAAiC;AAC7BmB,MAAAA,KAAK,CAACoC,YAAN,GAAqB3B,SAAS,CAAE,GAAE5B,IAAK,SAAT,CAA9B;AACH,KAFD,MAEO;AACH6B,MAAAA,YAAY,GAAG,IAAf;AACA2B,MAAAA,OAAO,CAACC,KAAR,CAAe,uBAAsBzD,IAAK,cAA1C;AACH;;AACDqD,gCAAgBD,MAAhB,CAAuBjC,KAAvB;AACH;;AACD,SAAOU,YAAP;AACH;;AAEM,SAAS6B,WAAT,CAAsBtF,IAAtB,EAAkC;AACrC,QAAMuF,MAAM,GAAGvF,IAAI,CAACuF,MAApB;;AACA,MAAI,CAACvF,IAAI,CAACwF,OAAL,CAAcC,iBAAf,IAAoCF,MAAM,CAAClF,MAAP,KAAkB,CAA1D,EAA6D;AACzDL,IAAAA,IAAI,CAAC0F,MAAL,GAAcH,MAAM,CAAC,CAAD,CAAN,CAAU/E,OAAxB;AACH,GAFD,MAEO;AACH,UAAMkF,MAAa,GAAG1F,IAAI,CAAC0F,MAAL,GAAc,EAApC;;AACA,SAAK,IAAIxF,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGoF,MAAM,CAAClF,MAA3B,EAAmCH,CAAC,GAAGC,CAAvC,EAA0CD,CAAC,EAA3C,EAA+C;AAC3CwF,MAAAA,MAAM,CAACpD,IAAP,CAAYiD,MAAM,CAACrF,CAAD,CAAN,CAAUM,OAAtB;AACH;AACJ;AACJ;;AAIM,SAASmF,OAAT,CAA2BC,KAA3B,EAAuCzE,OAAvC,EAAoEG,UAApE,EAAyG;AAC5G,MAAIuE,KAAK,GAAG,CAAZ;AACA,QAAMC,IAAa,GAAG,EAAtB;AACA,QAAMzF,MAAM,GAAGuF,KAAK,CAACvF,MAArB;;AACA,MAAIA,MAAM,KAAK,CAAX,IAAgBiB,UAApB,EAAgC;AAC5BA,IAAAA,UAAU,CAACwE,IAAD,CAAV;AACH;;AACD,QAAMC,EAAE,GAAIvE,GAAD,IAAS;AAChB,QAAIA,GAAJ,EAAS;AACLsE,MAAAA,IAAI,CAACxD,IAAL,CAAUd,GAAV;AACH;;AACDqE,IAAAA,KAAK;;AACL,QAAIA,KAAK,KAAKxF,MAAd,EAAsB;AAClB,UAAIiB,UAAJ,EAAgB;AACZA,QAAAA,UAAU,CAACwE,IAAD,CAAV;AACH;AACJ;AACJ,GAVD;;AAWA,OAAK,IAAI5F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGG,MAApB,EAA4BH,CAAC,EAA7B,EAAiC;AAC7BiB,IAAAA,OAAO,CAACyE,KAAK,CAAC1F,CAAD,CAAN,EAAW6F,EAAX,CAAP;AACH;AACJ;;AAcM,SAASC,eAAT,CACHR,OADG,EAEH1F,UAFG,EAGHwB,UAHG,EAG+C;AAClD,MAAI2E,UAAe,GAAGT,OAAtB;AACA,MAAIU,aAAkB,GAAGpG,UAAzB;AACA,MAAIqG,aAAkB,GAAG7E,UAAzB;;AACA,MAAIA,UAAU,KAAK2B,SAAnB,EAA8B;AAC1B,UAAMmD,UAAU,GAAG,OAAOZ,OAAP,KAAmB,UAAtC;;AACA,QAAI1F,UAAJ,EAAgB;AACZqG,MAAAA,aAAa,GAAGrG,UAAhB;;AACA,UAAI,CAACsG,UAAL,EAAiB;AACbF,QAAAA,aAAa,GAAG,IAAhB;AACH;AACJ,KALD,MAKO,IAAIpG,UAAU,KAAKmD,SAAf,IAA4BmD,UAAhC,EAA4C;AAC/CD,MAAAA,aAAa,GAAGX,OAAhB;AACAS,MAAAA,UAAU,GAAG,IAAb;AACAC,MAAAA,aAAa,GAAG,IAAhB;AACH;;AACD,QAAIpG,UAAU,KAAKmD,SAAf,IAA4BmD,UAAhC,EAA4C;AACxCF,MAAAA,aAAa,GAAGV,OAAhB;AACAS,MAAAA,UAAU,GAAG,IAAb;AACH;AACJ;;AAED,SAAO;AAAET,IAAAA,OAAO,EAAES,UAAU,IAAII,MAAM,CAACC,MAAP,CAAc,IAAd,CAAzB;AAA8CxG,IAAAA,UAAU,EAAEoG,aAA1D;AAAyE5E,IAAAA,UAAU,EAAE6E;AAArF,GAAP;AACH;;AAEM,SAASI,gBAAT,CACH/B,IADG,EAEH1E,UAFG,EAGHwB,UAHG,EAGgD;AACnD,MAAIkF,OAAY,GAAGhC,IAAnB;AACA,MAAI0B,aAAkB,GAAGpG,UAAzB;AACA,MAAIqG,aAAkB,GAAG7E,UAAzB;;AACA,MAAIA,UAAU,KAAK2B,SAAnB,EAA8B;AAC1B,UAAMwD,WAAW,GAAGC,OAAGC,cAAH,CAAkBnC,IAAlB,EAAqC/D,YAArC,CAApB;;AACA,QAAIX,UAAJ,EAAgB;AACZqG,MAAAA,aAAa,GAAGrG,UAAhB;;AACA,UAAI2G,WAAJ,EAAiB;AACbP,QAAAA,aAAa,GAAG,IAAhB;AACH;AACJ,KALD,MAKO,IAAIpG,UAAU,KAAKmD,SAAf,IAA4B,CAACwD,WAAjC,EAA8C;AACjDN,MAAAA,aAAa,GAAG3B,IAAhB;AACA0B,MAAAA,aAAa,GAAG,IAAhB;AACAM,MAAAA,OAAO,GAAG,IAAV;AACH;;AACD,QAAI1G,UAAU,KAAKmD,SAAf,IAA4B,CAACwD,WAAjC,EAA8C;AAC1CP,MAAAA,aAAa,GAAG1B,IAAhB;AACAgC,MAAAA,OAAO,GAAG,IAAV;AACH;AACJ;;AAED,SAAO;AAAEhC,IAAAA,IAAI,EAAEgC,OAAR;AAAiB1G,IAAAA,UAAU,EAAEoG,aAAa,IAAItG,uBAA9C;AAAuE0B,IAAAA,UAAU,EAAE6E;AAAnF,GAAP;AACH;;AAEM,SAASS,oBAAT,CAA+BxC,KAA/B,EAA8CxC,IAA9C,EAA4DiF,GAA5D,EAAsFC,OAAgC,GAAG,EAAzH,EAAsI;AACzI,QAAMxG,IAAI,GAAGuG,GAAG,CAACjF,IAAD,CAAhB;;AACA,MAAI,CAACtB,IAAD,IAASwG,OAAO,CAAClF,IAAD,CAApB,EAA4B;AACxB,WAAO,KAAP;AACH;;AACDkF,EAAAA,OAAO,CAAClF,IAAD,CAAP,GAAgB,IAAhB;AACA,MAAIH,MAAM,GAAG,KAAb;;AACA,QAAMW,IAAI,GAAGF,oBAAW6E,OAAX,CAAmBnF,IAAnB,CAAb;;AACA,MAAIQ,IAAJ,EAAU;AACN,SAAK,IAAIlC,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGiC,IAAI,CAAC/B,MAAzB,EAAiCH,CAAC,GAAGC,CAArC,EAAwCD,CAAC,EAAzC,EAA6C;AACzC,YAAMmC,GAAG,GAAGD,IAAI,CAAClC,CAAD,CAAhB;;AACA,UAAImC,GAAG,KAAK+B,KAAR,IAAiBwC,oBAAoB,CAACxC,KAAD,EAAQ/B,GAAR,EAAawE,GAAb,EAAkBC,OAAlB,CAAzC,EAAqE;AACjErF,QAAAA,MAAM,GAAG,IAAT;AACA;AACH;AACJ;AACJ;;AACD,SAAOA,MAAP;AACH;;AAEM,SAASuF,QAAT,CAAmBjB,EAAnB,EAA4F;AAC/F,SAAO,CAACkB,EAAD,EAAKC,EAAL,KAAY;AACf,QAAI,CAACnB,EAAL,EAAS;AAAE;AAAS;;AACpB,UAAMoB,IAAa,GAAG,EAAtB;;AACA,QAAIC,KAAK,CAACC,OAAN,CAAcH,EAAd,CAAJ,EAAuB;AACnBA,MAAAA,EAAE,CAACvB,OAAH,CAAY2B,CAAD,IAAOA,CAAC,YAAY7G,YAAb,IAAsB0G,IAAI,CAAC7E,IAAL,CAAUgF,CAAC,CAAC3C,MAAF,EAAV,CAAxC;AACH,KAFD,MAEO,IAAIuC,EAAE,YAAYzG,YAAlB,EAAyB;AAC5B0G,MAAAA,IAAI,CAAC7E,IAAL,CAAU4E,EAAE,CAACvC,MAAH,EAAV;AACH;;AACD,8BAAe,MAAM;AACjBwC,MAAAA,IAAI,CAACxB,OAAL,CAAc2B,CAAD,IAAOA,CAAC,CAAC5G,MAAF,CAAS,KAAT,CAApB;AACAqF,MAAAA,EAAE,CAACkB,EAAD,EAAKC,EAAL,CAAF;AACH,KAHD;AAIH,GAZD;AAaH"}
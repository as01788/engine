{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/renderer/scene/shadows.ts"],"names":["ShadowSize","Low_256x256","Medium_512x512","High_1024x1024","Ultra_2048x2048","ShadowType","Planar","ShadowMap","PCFType","HARD","SOFT","SOFT_2X","SHADOW_TYPE_NONE","Shadows","enabled","_enabled","val","_setEnable","activate","normal","_normal","Vec3","copy","JSB","_nativeObj","distance","_distance","shadowColor","_shadowColor","color","invisibleOcclusionRange","_invisibleOcclusionRange","shadowDistance","_shadowDistance","type","_type","_setType","near","_near","nearValue","far","_far","farValue","orthoSize","_orthoSize","size","_size","set","pcf","_pcf","pcfType","shadowMapDirty","_shadowMapDirty","bias","_bias","normalBias","_normalBias","saturation","_saturation","fixedArea","_fixedArea","matLight","_matLight","material","_material","instancingMaterial","_instancingMaterial","native","constructor","fixedSphere","Sphere","maxReceived","firstSetCSM","shadowCameraFar","matShadowView","Mat4","matShadowProj","matShadowViewProj","Color","Vec2","NativeShadow","getPlanarShader","patches","Material","initialize","effectName","planarPass","passes","getShaderVariant","getPlanarInstanceShader","defines","USE_INSTANCING","instancePass","shadowType","shadowsInfo","_updatePipeline","_updatePlanarInfo","root","legacyCC","director","pipeline","macros","CC_ENABLE_DIR_SHADOW","onGlobalPipelineStateChanged","_destroy","destroy","MAX_FAR","COEFFICIENT_OF_EXPANSION","Math","sqrt"],"mappings":";;;;;;;AAyBA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AAjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAaA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMA,UAAU,GAAG,kBAAK;AAC3B;AACJ;AACA;AACA;AACA;AACIC,EAAAA,WAAW,EAAE,GANc;;AAQ3B;AACJ;AACA;AACA;AACA;AACIC,EAAAA,cAAc,EAAE,GAbW;;AAe3B;AACJ;AACA;AACA;AACA;AACIC,EAAAA,cAAc,EAAE,IApBW;;AAsB3B;AACJ;AACA;AACA;AACA;AACIC,EAAAA,eAAe,EAAE;AA3BU,CAAL,CAAnB;AA8BP;AACA;AACA;AACA;AACA;;;AACO,MAAMC,UAAU,GAAG,kBAAK;AAC3B;AACJ;AACA;AACA;AACA;AACA;AACIC,EAAAA,MAAM,EAAE,CAPmB;;AAS3B;AACJ;AACA;AACA;AACA;AACA;AACIC,EAAAA,SAAS,EAAE;AAfgB,CAAL,CAAnB;AAkBP;AACA;AACA;AACA;AACA;AACA;;;AACO,MAAMC,OAAO,GAAG,kBAAK;AACxB;AACJ;AACA;AACA;AACA;AACIC,EAAAA,IAAI,EAAE,CANkB;;AAQxB;AACJ;AACA;AACA;AACA;AACIC,EAAAA,IAAI,EAAE,CAbkB;;AAexB;AACJ;AACA;AACA;AACA;AACIC,EAAAA,OAAO,EAAE;AApBe,CAAL,CAAhB;;AAuBP,MAAMC,gBAAgB,GAAGP,UAAU,CAACE,SAAX,GAAuB,CAAhD;;AAEO,MAAMM,OAAN,CAAc;AACjB;AACJ;AACA;AACA;;AAGI;AACJ;AACA;AACA;;AAGI;AACJ;AACA;AACA;AACe,MAAPC,OAAO,GAAa;AACpB,WAAO,KAAKC,QAAZ;AACH;;AAEU,MAAPD,OAAO,CAAEE,GAAF,EAAgB;AACvB,SAAKC,UAAL,CAAgBD,GAAhB;;AACA,SAAKE,QAAL;AACH;AAED;AACJ;AACA;AACA;;;AACc,MAANC,MAAM,GAAU;AAChB,WAAO,KAAKC,OAAZ;AACH;;AAES,MAAND,MAAM,CAAEH,GAAF,EAAa;AACnBK,iBAAKC,IAAL,CAAU,KAAKF,OAAf,EAAwBJ,GAAxB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBL,MAAjB,GAA0B,KAAKC,OAA/B;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACgB,MAARK,QAAQ,GAAY;AACpB,WAAO,KAAKC,SAAZ;AACH;;AAEW,MAARD,QAAQ,CAAET,GAAF,EAAe;AACvB,SAAKU,SAAL,GAAiBV,GAAjB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBC,QAAjB,GAA4BT,GAA5B;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACmB,MAAXW,WAAW,GAAW;AACtB,WAAO,KAAKC,YAAZ;AACH;;AAEc,MAAXD,WAAW,CAAEE,KAAF,EAAgB;AAC3B,SAAKD,YAAL,GAAoBC,KAApB;;AACA,QAAIN,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBK,KAAjB,GAAyBA,KAAzB;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACsC,MAAvBC,uBAAuB,GAAY;AAC1C,WAAO,KAAKC,wBAAZ;AACH;;AACiC,MAAvBD,uBAAuB,CAAEd,GAAF,EAAe;AAC7C,SAAKe,wBAAL,GAAgCf,GAAhC;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBM,uBAAjB,GAA2Cd,GAA3C;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AAC6B,MAAdgB,cAAc,GAAY;AACjC,WAAO,KAAKC,eAAZ;AACH;;AACwB,MAAdD,cAAc,CAAEhB,GAAF,EAAe;AACpC,SAAKiB,eAAL,GAAuBjB,GAAvB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBQ,cAAjB,GAAkChB,GAAlC;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACY,MAAJkB,IAAI,GAAY;AAChB,WAAO,KAAKC,KAAZ;AACH;;AACO,MAAJD,IAAI,CAAElB,GAAF,EAAe;AACnB,SAAKoB,QAAL,CAAcpB,GAAd;;AACA,SAAKE,QAAL;AACH;AAED;AACJ;AACA;AACA;;;AACmB,MAAJmB,IAAI,GAAY;AACvB,WAAO,KAAKC,KAAZ;AACH;;AACc,MAAJD,IAAI,CAAErB,GAAF,EAAe;AAC1B,SAAKsB,KAAL,GAAatB,GAAb;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBe,SAAjB,GAA6BvB,GAA7B;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACkB,MAAHwB,GAAG,GAAY;AACtB,WAAO,KAAKC,IAAZ;AACH;;AACa,MAAHD,GAAG,CAAExB,GAAF,EAAe;AACzB,SAAKyB,IAAL,GAAYzB,GAAZ;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBkB,QAAjB,GAA4B1B,GAA5B;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACwB,MAAT2B,SAAS,GAAY;AAC5B,WAAO,KAAKC,UAAZ;AACH;;AACmB,MAATD,SAAS,CAAE3B,GAAF,EAAe;AAC/B,SAAK4B,UAAL,GAAkB5B,GAAlB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBmB,SAAjB,GAA6B3B,GAA7B;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACmB,MAAJ6B,IAAI,GAAU;AACrB,WAAO,KAAKC,KAAZ;AACH;;AACc,MAAJD,IAAI,CAAE7B,GAAF,EAAa;AACxB,SAAK8B,KAAL,CAAWC,GAAX,CAAe/B,GAAf;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBqB,IAAjB,GAAwB7B,GAAxB;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACkB,MAAHgC,GAAG,GAAY;AACtB,WAAO,KAAKC,IAAZ;AACH;;AACa,MAAHD,GAAG,CAAEhC,GAAF,EAAe;AACzB,SAAKiC,IAAL,GAAYjC,GAAZ;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiB0B,OAAjB,GAA2BlC,GAA3B;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AAC6B,MAAdmC,cAAc,GAAa;AAClC,WAAO,KAAKC,eAAZ;AACH;;AACwB,MAAdD,cAAc,CAAEnC,GAAF,EAAgB;AACrC,SAAKoC,eAAL,GAAuBpC,GAAvB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiB2B,cAAjB,GAAkCnC,GAAlC;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACmB,MAAJqC,IAAI,GAAY;AACvB,WAAO,KAAKC,KAAZ;AACH;;AACc,MAAJD,IAAI,CAAErC,GAAF,EAAe;AAC1B,SAAKsC,KAAL,GAAatC,GAAb;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiB6B,IAAjB,GAAwBrC,GAAxB;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACyB,MAAVuC,UAAU,GAAY;AAC7B,WAAO,KAAKC,WAAZ;AACH;;AACoB,MAAVD,UAAU,CAAEvC,GAAF,EAAe;AAChC,SAAKwC,WAAL,GAAmBxC,GAAnB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiB+B,UAAjB,GAA8BvC,GAA9B;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACyB,MAAVyC,UAAU,GAAY;AAC7B,WAAO,KAAKC,WAAZ;AACH;;AACoB,MAAVD,UAAU,CAAEzC,GAAF,EAAe;AAChC,SAAK0C,WAAL,GAAmB1C,GAAnB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBiC,UAAjB,GAA8BzC,GAA9B;AACH;AACJ;AAED;AACJ;AACA;AACA;;;AACwB,MAAT2C,SAAS,GAAa;AAC7B,WAAO,KAAKC,UAAZ;AACH;;AACmB,MAATD,SAAS,CAAE3C,GAAF,EAAgB;AAChC,SAAK4C,UAAL,GAAkB5C,GAAlB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBmC,SAAjB,GAA6B3C,GAA7B;AACH;AACJ;;AAEkB,MAAR6C,QAAQ,GAAI;AACnB,WAAO,KAAKC,SAAZ;AACH;;AAEkB,MAARC,QAAQ,GAAc;AAC7B,WAAO,KAAKC,SAAZ;AACH;;AAE4B,MAAlBC,kBAAkB,GAAc;AACvC,WAAO,KAAKC,mBAAZ;AACH;AAED;AACJ;AACA;AACA;;;AAsCc,MAANC,MAAM,GAAkB;AACxB,WAAO,KAAK3C,UAAZ;AACH;;AAED4C,EAAAA,WAAW,GAAI;AAAA,SAzCRC,WAyCQ,GAzCc,IAAIC,aAAJ,CAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,IAA1B,CAyCd;AAAA,SAnCRC,WAmCQ,GAnCM,CAmCN;AAAA,SAhCRC,WAgCQ,GAhCM,KAgCN;AAAA,SA/BRC,eA+BQ,GA/BU,CA+BV;AAAA,SA9BRC,aA8BQ,GA9BQ,IAAIC,YAAJ,EA8BR;AAAA,SA7BRC,aA6BQ,GA7BQ,IAAID,YAAJ,EA6BR;AAAA,SA5BRE,iBA4BQ,GA5BY,IAAIF,YAAJ,EA4BZ;AAAA,SA1BLvD,OA0BK,GA1BK,IAAIC,YAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CA0BL;AAAA,SAzBLO,YAyBK,GAzBU,IAAIkD,aAAJ,CAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,EAAnB,CAyBV;AAAA,SAxBLhB,SAwBK,GAxBO,IAAIa,YAAJ,EAwBP;AAAA,SAvBLX,SAuBK,GAvBwB,IAuBxB;AAAA,SAtBLE,mBAsBK,GAtBkC,IAsBlC;AAAA,SArBLpB,KAqBK,GArBS,IAAIiC,YAAJ,CAAS,GAAT,EAAc,GAAd,CAqBT;AAAA,SApBLhE,QAoBK,GApBM,KAoBN;AAAA,SAnBLW,SAmBK,GAnBO,CAmBP;AAAA,SAlBLS,KAkBK,GAlBGvB,gBAkBH;AAAA,SAjBL0B,KAiBK,GAjBG,GAiBH;AAAA,SAhBLG,IAgBK,GAhBE,EAgBF;AAAA,SAfLV,wBAeK,GAfsB,GAetB;AAAA,SAdLE,eAcK,GAda,GAcb;AAAA,SAbLW,UAaK,GAbQ,CAaR;AAAA,SAZLK,IAYK,GAZE,CAYF;AAAA,SAXLG,eAWK,GAXa,KAWb;AAAA,SAVLE,KAUK,GAVG,CAUH;AAAA,SATLE,WASK,GATS,CAST;AAAA,SARLI,UAQK,GARQ,KAQR;AAAA,SAPLF,WAOK,GAPS,IAOT;;AACX,QAAInC,0BAAJ,EAAS;AACL,WAAKC,UAAL,GAAkB,IAAIwD,yBAAJ,EAAlB;AACH;AACJ;;AAEMC,EAAAA,eAAe,CAAEC,OAAF,EAAgD;AAClE,QAAI,CAAC,KAAKlB,SAAV,EAAqB;AACjB,WAAKA,SAAL,GAAiB,IAAImB,kBAAJ,EAAjB;;AACA,WAAKnB,SAAL,CAAeoB,UAAf,CAA0B;AAAEC,QAAAA,UAAU,EAAE;AAAd,OAA1B;;AACA,UAAI9D,0BAAJ,EAAS;AACL,aAAKC,UAAL,CAAiB8D,UAAjB,GAA8B,KAAKtB,SAAL,CAAeuB,MAAf,CAAsB,CAAtB,EAAyBpB,MAAvD;AACH;AACJ;;AAED,WAAO,KAAKH,SAAL,CAAeuB,MAAf,CAAsB,CAAtB,EAAyBC,gBAAzB,CAA0CN,OAA1C,CAAP;AACH;;AAEMO,EAAAA,uBAAuB,CAAEP,OAAF,EAAgD;AAC1E,QAAI,CAAC,KAAKhB,mBAAV,EAA+B;AAC3B,WAAKA,mBAAL,GAA2B,IAAIiB,kBAAJ,EAA3B;;AACA,WAAKjB,mBAAL,CAAyBkB,UAAzB,CAAoC;AAAEC,QAAAA,UAAU,EAAE,eAAd;AAA+BK,QAAAA,OAAO,EAAE;AAAEC,UAAAA,cAAc,EAAE;AAAlB;AAAxC,OAApC;;AACA,UAAIpE,0BAAJ,EAAS;AACL,aAAKC,UAAL,CAAiBoE,YAAjB,GAAgC,KAAK1B,mBAAL,CAAyBqB,MAAzB,CAAgC,CAAhC,EAAmCpB,MAAnE;AACH;AACJ;;AAED,WAAO,KAAKD,mBAAL,CAAyBqB,MAAzB,CAAgC,CAAhC,EAAmCC,gBAAnC,CAAoDN,OAApD,CAAP;AACH;;AAEOjE,EAAAA,UAAU,CAAED,GAAF,EAAgB;AAC9B,SAAKD,QAAL,GAAgBC,GAAhB;;AACA,QAAIO,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBV,OAAjB,GAA2BE,GAA3B;AACA,UAAI,CAACA,GAAL,EAAU,KAAKoB,QAAL,CAAcxB,gBAAd;AACb;AACJ;;AAEOwB,EAAAA,QAAQ,CAAEpB,GAAF,EAAO;AACnB,SAAKmB,KAAL,GAAa,KAAKrB,OAAL,GAAeE,GAAf,GAAqBJ,gBAAlC;;AACA,QAAIW,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBqE,UAAjB,GAA8B,KAAK1D,KAAnC;AACH;AACJ;;AAEMiD,EAAAA,UAAU,CAAEU,WAAF,EAA4B;AACzC,SAAKzD,IAAL,GAAYyD,WAAW,CAACzD,IAAxB;AACA,SAAKG,GAAL,GAAWsD,WAAW,CAACtD,GAAvB;AACA,SAAKV,uBAAL,GAA+BgE,WAAW,CAAChE,uBAA3C;AACA,SAAKE,cAAL,GAAsB8D,WAAW,CAAC9D,cAAlC;AACA,SAAKW,SAAL,GAAiBmD,WAAW,CAACnD,SAA7B;AACA,SAAKE,IAAL,GAAYiD,WAAW,CAACjD,IAAxB;AACA,SAAKG,GAAL,GAAW8C,WAAW,CAAC9C,GAAvB;AACA,SAAK7B,MAAL,GAAc2E,WAAW,CAAC3E,MAA1B;AACA,SAAKM,QAAL,GAAgBqE,WAAW,CAACrE,QAA5B;AACA,SAAKE,WAAL,GAAmBmE,WAAW,CAACnE,WAA/B;AACA,SAAK0B,IAAL,GAAYyC,WAAW,CAACzC,IAAxB;AACA,SAAKE,UAAL,GAAkBuC,WAAW,CAACvC,UAA9B;AACA,SAAKgB,WAAL,GAAmBuB,WAAW,CAACvB,WAA/B;AACA,SAAKZ,SAAL,GAAiBmC,WAAW,CAACnC,SAA7B;;AACA,SAAK1C,UAAL,CAAgB6E,WAAW,CAAChF,OAA5B;;AACA,SAAKsB,QAAL,CAAc0D,WAAW,CAAC5D,IAA1B;;AACA,SAAKuB,UAAL,GAAkBqC,WAAW,CAACrC,UAA9B;AACH;;AAEMvC,EAAAA,QAAQ,GAAI;AACf,QAAI,KAAKJ,OAAT,EAAkB;AACd,UAAI,KAAKoB,IAAL,KAAc7B,UAAU,CAACE,SAA7B,EAAwC;AACpC,aAAKwF,eAAL;AACH,OAFD,MAEO;AACH,aAAKC,iBAAL;AACH;AACJ,KAND,MAMO;AACH,YAAMC,IAAI,GAAGC,wBAASC,QAAT,CAAkBF,IAA/B;AACA,YAAMG,QAAQ,GAAGH,IAAI,CAACG,QAAtB;AACAA,MAAAA,QAAQ,CAACC,MAAT,CAAgBC,oBAAhB,GAAuC,CAAvC;AACAL,MAAAA,IAAI,CAACM,4BAAL;AACH;AACJ;;AAESP,EAAAA,iBAAiB,GAAI;AAC3B,QAAI,CAAC,KAAKhC,SAAV,EAAqB;AACjB,WAAKA,SAAL,GAAiB,IAAImB,kBAAJ,EAAjB;;AACA,WAAKnB,SAAL,CAAeoB,UAAf,CAA0B;AAAEC,QAAAA,UAAU,EAAE;AAAd,OAA1B;;AACA,UAAI9D,0BAAJ,EAAS;AACL,aAAKC,UAAL,CAAiB8D,UAAjB,GAA8B,KAAKtB,SAAL,CAAeuB,MAAf,CAAsB,CAAtB,EAAyBpB,MAAvD;AACH;AACJ;;AACD,QAAI,CAAC,KAAKD,mBAAV,EAA+B;AAC3B,WAAKA,mBAAL,GAA2B,IAAIiB,kBAAJ,EAA3B;;AACA,WAAKjB,mBAAL,CAAyBkB,UAAzB,CAAoC;AAAEC,QAAAA,UAAU,EAAE,eAAd;AAA+BK,QAAAA,OAAO,EAAE;AAAEC,UAAAA,cAAc,EAAE;AAAlB;AAAxC,OAApC;;AACA,UAAIpE,0BAAJ,EAAS;AACL,aAAKC,UAAL,CAAiBoE,YAAjB,GAAgC,KAAK1B,mBAAL,CAAyBqB,MAAzB,CAAgC,CAAhC,EAAmCpB,MAAnE;AACH;AACJ;;AAED,UAAM8B,IAAI,GAAGC,wBAASC,QAAT,CAAkBF,IAA/B;AACA,UAAMG,QAAQ,GAAGH,IAAI,CAACG,QAAtB;AACAA,IAAAA,QAAQ,CAACC,MAAT,CAAgBC,oBAAhB,GAAuC,CAAvC;AACAL,IAAAA,IAAI,CAACM,4BAAL;AACH;;AAESR,EAAAA,eAAe,GAAI;AACzB,UAAME,IAAI,GAAGC,wBAASC,QAAT,CAAkBF,IAA/B;AACA,UAAMG,QAAQ,GAAGH,IAAI,CAACG,QAAtB;AACAA,IAAAA,QAAQ,CAACC,MAAT,CAAgBC,oBAAhB,GAAuC,CAAvC;AACAL,IAAAA,IAAI,CAACM,4BAAL;AACH;;AAESC,EAAAA,QAAQ,GAAI;AAClB,QAAIjF,0BAAJ,EAAS;AACL,WAAKC,UAAL,GAAkB,IAAlB;AACH;AACJ;;AAEMiF,EAAAA,OAAO,GAAI;AACd,SAAKD,QAAL;;AACA,QAAI,KAAKxC,SAAT,EAAoB;AAChB,WAAKA,SAAL,CAAeyC,OAAf;AACH;;AAED,QAAI,KAAKvC,mBAAT,EAA8B;AAC1B,WAAKA,mBAAL,CAAyBuC,OAAzB;AACH;;AACD,SAAKpC,WAAL,CAAiBoC,OAAjB;AACH;;AAjbgB;;;AAAR5F,O,CAKc6F,O,GAAkB,M;AALhC7F,O,CAWc8F,wB,GAAmC,MAAMC,IAAI,CAACC,IAAL,CAAU,GAAV,C;AAyapEX,wBAASrF,OAAT,GAAmBA,OAAnB"}
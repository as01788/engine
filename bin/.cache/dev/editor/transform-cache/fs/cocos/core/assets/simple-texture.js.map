{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/assets/simple-texture.ts"],"names":["_regions","BufferTextureCopy","getMipLevel","width","height","size","Math","max","level","isPOT","n","canGenerateMipmap","device","w","h","needCheckPOT","gfxAPI","API","WEBGL","SimpleTexture","TextureBase","_gfxTexture","_mipmapLevel","_textureWidth","_textureHeight","mipmapLevel","getGFXTexture","destroy","_tryDestroyTexture","updateImage","updateMipmaps","firstLevel","count","uploadData","source","arrayIndex","gfxDevice","_getGFXDevice","region","texExtent","texSubres","mipLevel","baseArrayLayer","DEV","HTMLElement","name","ArrayBuffer","isView","copyBuffersToTexture","copyTexImagesToTexture","_assignImage","image","data","_checkTextureLoaded","macro","CLEANUP_IMAGE_CACHE","deps","dependUtil","getDeps","_uuid","index","indexOf","decRef","_textureReady","loaded","emit","_setMipmapLevel","value","_getGfxTextureCreateInfo","presumed","_tryReset","_createTexture","_width","_height","flags","TextureFlagBit","NONE","_mipFilter","Filter","GEN_MIPMAP","textureCreateInfo","usage","TextureUsageBit","SAMPLED","TRANSFER_DST","format","_getGFXFormat","levelCount","texture","createTexture","legacyCC"],"mappings":"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"}
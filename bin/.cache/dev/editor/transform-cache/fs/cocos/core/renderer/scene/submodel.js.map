{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/renderer/scene/submodel.ts"],"names":["_dsInfo","DescriptorSetInfo","MAX_PASS_COUNT","SubModel","_device","_passes","_shaders","_subMesh","_patches","_priority","RenderPriority","DEFAULT","_inputAssembler","_descriptorSet","_worldBoundDescriptorSet","_planarInstanceShader","_planarShader","_reflectionTex","_reflectionSampler","_destroyDescriptorSet","destroy","JSB","_nativeObj","setDescriptorSet","_destroyWorldBoundDescriptorSet","setWorldBoundDescriptorSet","_destroyInputAssembler","setInputAssembler","_createDescriptorSet","descInfo","createDescriptorSet","_createWorldBoundDescriptorSet","passes","passLengh","length","_flushPassInfo","batchingScheme","BatchingSchemes","VB_MERGING","subMesh","genFlatBuffers","_setSubMesh","layout","localSetLayout","shaders","initialize","iaInfo","priority","val","setPriority","inputAssembler","descriptorSet","worldBoundDescriptorSet","patches","planarInstanceShader","planarShader","_setInputAssembler","createInputAssembler","setSubMeshBuffers","flatBuffers","native","_init","NativeSubModel","root","legacyCC","director","device","pipeline","occlusionPass","pipelineSceneData","getOcclusionQueryPass","occlusionDSInfo","phase","texWidth","mainWindow","width","texHeight","height","minSize","createTexture","TextureInfo","TextureType","TEX2D","TextureUsageBit","STORAGE","TRANSFER_SRC","SAMPLED","Format","RGBA8","bindTexture","UNIFORM_REFLECTION_TEXTURE_BINDING","getSampler","SamplerInfo","Filter","LINEAR","NONE","Address","CLAMP","bindSampler","UNIFORM_REFLECTION_STORAGE_BINDING","_initNativePlanarShadowShader","shadowInfo","getPlanarShader","setPlanarShader","initPlanarShadowShader","shadows","_initNativePlanarShadowInstanceShader","getPlanarInstanceShader","setPlanarInstanceShader","initPlanarShadowInstanceShader","_destroy","update","i","pass","onPipelineStateChanged","beginChangeStatesSilently","tryCompile","endChangeStatesSilently","onMacroPatchesStateChanged","len","getShaderVariant","passesNative","map","_pass","setPasses","setShaders"],"mappings":";;;;;;;AAyBA;;AAEA;;AACA;;AACA;;AAEA;;AAEA;;AAEA;;AACA;;AApCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAgBA,MAAMA,OAAO,GAAG,IAAIC,wBAAJ,CAAsB,IAAtB,CAAhB;;AACA,MAAMC,cAAc,GAAG,CAAvB;;AACO,MAAMC,QAAN,CAAe;AAAA;AAAA,SACRC,OADQ,GACiB,IADjB;AAAA,SAERC,OAFQ,GAEiB,IAFjB;AAAA,SAGRC,QAHQ,GAGoB,IAHpB;AAAA,SAIRC,QAJQ,GAI4B,IAJ5B;AAAA,SAKRC,QALQ,GAKyB,IALzB;AAAA,SAMRC,SANQ,GAMoBC,uBAAeC,OANnC;AAAA,SAORC,eAPQ,GAOiC,IAPjC;AAAA,SAQRC,cARQ,GAQ+B,IAR/B;AAAA,SASRC,wBATQ,GASyC,IATzC;AAAA,SAURC,qBAVQ,GAU+B,IAV/B;AAAA,SAWRC,aAXQ,GAWuB,IAXvB;AAAA,SAYRC,cAZQ,GAYyB,IAZzB;AAAA,SAaRC,kBAbQ,GAa6B,IAb7B;AAAA;;AAgBVC,EAAAA,qBAAqB,GAAI;AAC7B,SAAKN,cAAL,CAAqBO,OAArB;;AACA,QAAIC,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBC,gBAAjB,CAAkC,IAAlC;AACH;;AACD,SAAKV,cAAL,GAAsB,IAAtB;AACH;;AAEOW,EAAAA,+BAA+B,GAAI;AACvC,SAAKV,wBAAL,CAA+BM,OAA/B;;AACA,QAAIC,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBG,0BAAjB,CAA4C,IAA5C;AACH;;AACD,SAAKX,wBAAL,GAAgC,IAAhC;AACH;;AAEOY,EAAAA,sBAAsB,GAAI;AAC9B,SAAKd,eAAL,CAAsBQ,OAAtB;;AACA,QAAIC,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBK,iBAAjB,CAAmC,IAAnC;AACH;;AACD,SAAKf,eAAL,GAAuB,IAAvB;AACH;;AAEOgB,EAAAA,oBAAoB,CAAEC,QAAF,EAA+B;AACvD,SAAKhB,cAAL,GAAsB,KAAKT,OAAL,CAAc0B,mBAAd,CAAkCD,QAAlC,CAAtB;;AACA,QAAIR,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBC,gBAAjB,CAAkC,KAAKV,cAAvC;AACH;AACJ;;AAEOkB,EAAAA,8BAA8B,CAAEF,QAAF,EAA+B;AACjE,SAAKf,wBAAL,GAAgC,KAAKV,OAAL,CAAc0B,mBAAd,CAAkCD,QAAlC,CAAhC;;AACA,QAAIR,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBG,0BAAjB,CAA4C,KAAKX,wBAAjD;AACH;AACJ;;AAES,MAANkB,MAAM,CAAEA,MAAF,EAAU;AAChB,UAAMC,SAAS,GAAGD,MAAM,CAACE,MAAzB;;AACA,QAAID,SAAS,GAAG/B,cAAhB,EAAgC;AAC5B,0BAAQ,KAAR,EAAeA,cAAf;AACA;AACH;;AACD,SAAKG,OAAL,GAAe2B,MAAf;;AACA,SAAKG,cAAL;;AACA,QAAI,KAAK9B,OAAL,CAAa,CAAb,EAAgB+B,cAAhB,KAAmCC,uBAAgBC,UAAvD,EAAmE;AAC/D,WAAKC,OAAL,CAAaC,cAAb;;AACA,WAAKC,WAAL,CAAiB,KAAKF,OAAtB;AACH,KAXe,CAahB;;;AACA,QAAI,KAAK1B,cAAT,EAAyB;AACrB,WAAKM,qBAAL;;AACAnB,MAAAA,OAAO,CAAC0C,MAAR,GAAiBV,MAAM,CAAC,CAAD,CAAN,CAAUW,cAA3B;;AACA,WAAKf,oBAAL,CAA0B5B,OAA1B;AACH;AACJ;;AAES,MAANgC,MAAM,GAAY;AAClB,WAAO,KAAK3B,OAAZ;AACH;;AAEU,MAAPuC,OAAO,GAAc;AACrB,WAAO,KAAKtC,QAAZ;AACH;;AAEU,MAAPiC,OAAO,CAAEA,OAAF,EAAW;AAClB,SAAK3B,eAAL,CAAsBQ,OAAtB;;AACA,SAAKR,eAAL,CAAsBiC,UAAtB,CAAiCN,OAAO,CAACO,MAAzC;;AACA,QAAI,KAAKzC,OAAL,CAAc,CAAd,EAAiB+B,cAAjB,KAAoCC,uBAAgBC,UAAxD,EAAoE;AAAE,WAAKC,OAAL,CAAaC,cAAb;AAAgC;;AACtG,SAAKC,WAAL,CAAiBF,OAAjB;AACH;;AAEU,MAAPA,OAAO,GAAsB;AAC7B,WAAO,KAAKhC,QAAZ;AACH;;AAEW,MAARwC,QAAQ,CAAEC,GAAF,EAAO;AACf,SAAKvC,SAAL,GAAiBuC,GAAjB;;AACA,QAAI3B,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiB2B,WAAjB,CAA6BD,GAA7B;AACH;AACJ;;AAEW,MAARD,QAAQ,GAAoB;AAC5B,WAAO,KAAKtC,SAAZ;AACH;;AAEiB,MAAdyC,cAAc,GAAoB;AAClC,WAAO,KAAKtC,eAAZ;AACH;;AAEgB,MAAbuC,aAAa,GAAmB;AAChC,WAAO,KAAKtC,cAAZ;AACH;;AAE0B,MAAvBuC,uBAAuB,GAAmB;AAC1C,WAAO,KAAKtC,wBAAZ;AACH;;AAEU,MAAPuC,OAAO,GAA0B;AACjC,WAAO,KAAK7C,QAAZ;AACH;;AAEuB,MAApB8C,oBAAoB,GAAmB;AACvC,WAAO,KAAKvC,qBAAZ;AACH;;AAEe,MAAZwC,YAAY,GAAmB;AAC/B,WAAO,KAAKvC,aAAZ;AACH;;AAEOwC,EAAAA,kBAAkB,CAAEV,MAAF,EAA8B;AACpD,SAAKlC,eAAL,GAAuB,KAAKR,OAAL,CAAcqD,oBAAd,CAAmCX,MAAnC,CAAvB;;AACA,QAAIzB,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBK,iBAAjB,CAAmC,KAAKf,eAAxC;AACH;AACJ;;AAEO6B,EAAAA,WAAW,CAAEF,OAAF,EAA6B;AAC5C,SAAKhC,QAAL,GAAgBgC,OAAhB;;AACA,QAAIlB,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBoC,iBAAjB,CAAmCnB,OAAO,CAACoB,WAA3C;AACH;AACJ;;AAES,MAANC,MAAM,GAAoB;AAC1B,WAAO,KAAKtC,UAAZ;AACH;;AAEOuC,EAAAA,KAAK,GAAI;AACb,QAAIxC,0BAAJ,EAAS;AACL,WAAKC,UAAL,GAAkB,IAAIwC,2BAAJ,EAAlB;AACH;AACJ;;AAEMjB,EAAAA,UAAU,CAAEN,OAAF,EAA6BP,MAA7B,EAA6CqB,OAA6B,GAAG,IAA7E,EAAyF;AACtG,UAAMU,IAAI,GAAGC,wBAASC,QAAT,CAAkBF,IAA/B;AACA,SAAK3D,OAAL,GAAe2D,IAAI,CAACG,MAApB;AACAlE,IAAAA,OAAO,CAAC0C,MAAR,GAAiBV,MAAM,CAAC,CAAD,CAAN,CAAUW,cAA3B;;AACA,SAAKkB,KAAL;;AACA,SAAKL,kBAAL,CAAwBjB,OAAO,CAACO,MAAhC;;AACA,SAAKlB,oBAAL,CAA0B5B,OAA1B;;AAEA,UAAMmE,QAAQ,GAAGH,wBAASC,QAAT,CAAkBF,IAAlB,CAAuBI,QAAxC;AACA,UAAMC,aAAa,GAAGD,QAAQ,CAACE,iBAAT,CAA2BC,qBAA3B,EAAtB;AACA,UAAMC,eAAe,GAAG,IAAItE,wBAAJ,CAAsB,IAAtB,CAAxB;AACAsE,IAAAA,eAAe,CAAC7B,MAAhB,GAAyB0B,aAAa,CAACzB,cAAvC;;AACA,SAAKZ,8BAAL,CAAoCwC,eAApC;;AACA,SAAK9B,WAAL,CAAiBF,OAAjB;;AACA,SAAK/B,QAAL,GAAgB6C,OAAhB;AACA,SAAKhD,OAAL,GAAe2B,MAAf;;AAEA,SAAKG,cAAL;;AACA,QAAIH,MAAM,CAAC,CAAD,CAAN,CAAUI,cAAV,KAA6BC,uBAAgBC,UAAjD,EAA6D;AACzD,WAAKC,OAAL,CAAaC,cAAb;;AACA,WAAKC,WAAL,CAAiB,KAAKF,OAAtB;AACH;;AAED,SAAKQ,QAAL,GAAgBrC,uBAAeC,OAA/B,CAvBsG,CAyBtG;;AACA,QAAIqB,MAAM,CAAC,CAAD,CAAN,CAAUwC,KAAV,KAAoB,2BAAW,YAAX,CAAxB,EAAkD;AAC9C,UAAIC,QAAQ,GAAGV,IAAI,CAACW,UAAL,CAAiBC,KAAhC;AACA,UAAIC,SAAS,GAAGb,IAAI,CAACW,UAAL,CAAiBG,MAAjC;AACA,YAAMC,OAAO,GAAG,GAAhB;;AAEA,UAAIF,SAAS,GAAGH,QAAhB,EAA0B;AACtBA,QAAAA,QAAQ,GAAGK,OAAO,GAAGL,QAAV,GAAqBG,SAAhC;AACAA,QAAAA,SAAS,GAAGE,OAAZ;AACH,OAHD,MAGO;AACHL,QAAAA,QAAQ,GAAGK,OAAX;AACAF,QAAAA,SAAS,GAAGE,OAAO,GAAGF,SAAV,GAAsBH,QAAlC;AACH;;AAED,WAAKxD,cAAL,GAAsB,KAAKb,OAAL,CAAa2E,aAAb,CAA2B,IAAIC,kBAAJ,CAC7CC,mBAAYC,KADiC,EAE7CC,uBAAgBC,OAAhB,GAA0BD,uBAAgBE,YAA1C,GAAyDF,uBAAgBG,OAF5B,EAG7CC,cAAOC,KAHsC,EAI7Cf,QAJ6C,EAK7CG,SAL6C,CAA3B,CAAtB;AAQA,WAAKzB,aAAL,CAAmBsC,WAAnB,CAA+BC,0CAA/B,EAAmE,KAAKzE,cAAxE;AAEA,WAAKC,kBAAL,GAA0B,KAAKd,OAAL,CAAauF,UAAb,CAAwB,IAAIC,kBAAJ,CAC9CC,cAAOC,MADuC,EAE9CD,cAAOC,MAFuC,EAG9CD,cAAOE,IAHuC,EAI9CC,eAAQC,KAJsC,EAK9CD,eAAQC,KALsC,EAM9CD,eAAQC,KANsC,CAAxB,CAA1B;AAQA,WAAK9C,aAAL,CAAmB+C,WAAnB,CAA+BR,0CAA/B,EAAmE,KAAKxE,kBAAxE;AACA,WAAKiC,aAAL,CAAmBsC,WAAnB,CAA+BU,0CAA/B,EAAmE,KAAKlF,cAAxE;AACH;AACJ;;AAEOmF,EAAAA,6BAA6B,CAAEC,UAAF,EAAuB;AACxD,SAAKrF,aAAL,GAAqBqF,UAAU,CAACC,eAAX,CAA2B,KAAK9F,QAAhC,CAArB;;AACA,QAAIa,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBiF,eAAjB,CAAiC,KAAKvF,aAAtC;AACH;AACJ,GA5NiB,CA8NlB;AACA;;;AACOwF,EAAAA,sBAAsB,GAAI;AAC7B,UAAMrC,QAAQ,GAAGH,wBAASC,QAAT,CAAkBF,IAAlB,CAAuBI,QAAxC;AACA,UAAMkC,UAAU,GAAGlC,QAAQ,CAACE,iBAAT,CAA2BoC,OAA9C;;AACA,SAAKL,6BAAL,CAAmCC,UAAnC;AACH;;AAEOK,EAAAA,qCAAqC,CAAEL,UAAF,EAAuB;AAChE,SAAKtF,qBAAL,GAA6BsF,UAAU,CAACM,uBAAX,CAAmC,KAAKnG,QAAxC,CAA7B;;AACA,QAAIa,0BAAJ,EAAS;AACL,WAAKC,UAAL,CAAiBsF,uBAAjB,CAAyC,KAAK7F,qBAA9C;AACH;AACJ,GA3OiB,CA6OlB;AACA;;;AACO8F,EAAAA,8BAA8B,GAAI;AACrC,UAAM1C,QAAQ,GAAGH,wBAASC,QAAT,CAAkBF,IAAlB,CAAuBI,QAAxC;AACA,UAAMkC,UAAU,GAAGlC,QAAQ,CAACE,iBAAT,CAA2BoC,OAA9C;;AACA,SAAKC,qCAAL,CAA2CL,UAA3C;AACH;;AAEOS,EAAAA,QAAQ,GAAI;AAChB,QAAIzF,0BAAJ,EAAS;AACL,WAAKC,UAAL,GAAkB,IAAlB;AACH;AACJ;;AAEMF,EAAAA,OAAO,GAAU;AACpB,SAAKD,qBAAL;;AACA,SAAKK,+BAAL;;AACA,SAAKE,sBAAL;;AACA,SAAKqB,QAAL,GAAgBrC,uBAAeC,OAA/B;AAEA,SAAKH,QAAL,GAAgB,IAAhB;AACA,SAAKD,QAAL,GAAgB,IAAhB;AAEA,SAAKF,OAAL,GAAe,IAAf;AACA,SAAKC,QAAL,GAAgB,IAAhB;AAEA,QAAI,KAAKW,cAAT,EAAyB,KAAKA,cAAL,CAAoBG,OAApB;AACzB,SAAKH,cAAL,GAAsB,IAAtB;AACA,SAAKC,kBAAL,GAA0B,IAA1B;;AAEA,SAAK4F,QAAL;AACH;;AAEMC,EAAAA,MAAM,GAAU;AACnB,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK3G,OAAL,CAAc6B,MAAlC,EAA0C,EAAE8E,CAA5C,EAA+C;AAC3C,YAAMC,IAAI,GAAG,KAAK5G,OAAL,CAAc2G,CAAd,CAAb;AACAC,MAAAA,IAAI,CAACF,MAAL;AACH;;AACD,SAAKlG,cAAL,CAAqBkG,MAArB;;AACA,SAAKjG,wBAAL,CAA+BiG,MAA/B;AACH;;AAEMG,EAAAA,sBAAsB,GAAU;AACnC,UAAMlF,MAAM,GAAG,KAAK3B,OAApB;;AACA,QAAI,CAAC2B,MAAL,EAAa;AAAE;AAAS;;AAExB,SAAK,IAAIgF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGhF,MAAM,CAACE,MAA3B,EAAmC8E,CAAC,EAApC,EAAwC;AACpC,YAAMC,IAAI,GAAGjF,MAAM,CAACgF,CAAD,CAAnB;AACAC,MAAAA,IAAI,CAACE,yBAAL;AACAF,MAAAA,IAAI,CAACG,UAAL,GAHoC,CAGjB;;AACnBH,MAAAA,IAAI,CAACI,uBAAL;AACH;;AAED,SAAKlF,cAAL;AACH;;AAEMmF,EAAAA,0BAA0B,CAAEjE,OAAF,EAAuC;AACpE,SAAK7C,QAAL,GAAgB6C,OAAhB;AAEA,UAAMrB,MAAM,GAAG,KAAK3B,OAApB;;AACA,QAAI,CAAC2B,MAAL,EAAa;AAAE;AAAS;;AAExB,SAAK,IAAIgF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGhF,MAAM,CAACE,MAA3B,EAAmC8E,CAAC,EAApC,EAAwC;AACpC,YAAMC,IAAI,GAAGjF,MAAM,CAACgF,CAAD,CAAnB;AACAC,MAAAA,IAAI,CAACE,yBAAL;AACAF,MAAAA,IAAI,CAACG,UAAL,GAHoC,CAGjB;;AACnBH,MAAAA,IAAI,CAACI,uBAAL;AACH;;AAED,SAAKlF,cAAL;AACH;;AAESA,EAAAA,cAAc,GAAU;AAC9B,UAAMH,MAAM,GAAG,KAAK3B,OAApB;;AACA,QAAI,CAAC2B,MAAL,EAAa;AAAE;AAAS;;AACxB,QAAI,CAAC,KAAK1B,QAAV,EAAoB;AAAE,WAAKA,QAAL,GAAgB,EAAhB;AAAqB;;AAE3C,SAAKA,QAAL,CAAc4B,MAAd,GAAuBF,MAAM,CAACE,MAA9B;;AACA,SAAK,IAAI8E,CAAC,GAAG,CAAR,EAAWO,GAAG,GAAGvF,MAAM,CAACE,MAA7B,EAAqC8E,CAAC,GAAGO,GAAzC,EAA8CP,CAAC,EAA/C,EAAmD;AAC/C,WAAK1G,QAAL,CAAc0G,CAAd,IAAmBhF,MAAM,CAACgF,CAAD,CAAN,CAAUQ,gBAAV,CAA2B,KAAKnE,OAAhC,CAAnB;AACH;;AAED,QAAIhC,0BAAJ,EAAS;AACL,YAAMoG,YAAY,GAAGzF,MAAM,CAAC0F,GAAP,CAAYC,KAAD,IAA6BA,KAAK,CAAC/D,MAA9C,CAArB;;AACA,WAAKtC,UAAL,CAAiBsG,SAAjB,CAA2BH,YAA3B;;AACA,WAAKnG,UAAL,CAAiBuG,UAAjB,CAA4B,KAAKvH,QAAjC;AACH;AACJ;;AApUiB"}
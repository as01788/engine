{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/gfx/webgl2/webgl2-swapchain.ts"],"names":["eventWebGLContextLost","initStates","gl","activeTexture","TEXTURE0","pixelStorei","PACK_ALIGNMENT","UNPACK_ALIGNMENT","UNPACK_FLIP_Y_WEBGL","bindFramebuffer","FRAMEBUFFER","enable","SCISSOR_TEST","CULL_FACE","cullFace","BACK","frontFace","CCW","polygonOffset","DEPTH_TEST","depthMask","depthFunc","LESS","stencilFuncSeparate","FRONT","ALWAYS","stencilOpSeparate","KEEP","stencilMaskSeparate","disable","STENCIL_TEST","SAMPLE_ALPHA_TO_COVERAGE","BLEND","blendEquationSeparate","FUNC_ADD","blendFuncSeparate","ONE","ZERO","colorMask","blendColor","getExtension","ext","prefixes","i","length","_ext","getExtensions","res","EXT_texture_filter_anisotropic","EXT_color_buffer_half_float","EXT_color_buffer_float","WEBGL_multi_draw","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_shaders","WEBGL_lose_context","WEBGL_debug_renderer_info","OES_texture_half_float_linear","OES_texture_float_linear","useVAO","getContext","canvas","context","webGLCtxAttribs","alpha","macro","ENABLE_TRANSPARENT_CANVAS","antialias","EDITOR","ENABLE_WEBGL_ANTIALIAS","depth","stencil","premultipliedAlpha","preserveDrawingBuffer","powerPreference","failIfMajorPerformanceCaveat","err","WebGL2Swapchain","Swapchain","stateCache","WebGL2StateCache","nullTex2D","nullTexCube","_canvas","_webGL2ContextLostHandler","_extensions","extensions","initialize","info","windowHandle","_onWebGLContextLost","bind","addEventListener","WebGL2DeviceManager","instance","capabilities","maxTextureUnits","maxUniformBufferBindings","maxVertexAttributes","colorFmt","Format","RGBA8","depthStencilFmt","DEPTH_STENCIL","depthBits","getParameter","DEPTH_BITS","stencilBits","STENCIL_BITS","DEPTH","_colorTexture","WebGL2Texture","initAsSwapchainTexture","swapchain","format","width","height","_depthStencilTexture","createTexture","TextureInfo","TextureType","TEX2D","TextureUsageBit","SAMPLED","TextureFlagBit","NONE","CUBE","nullTexRegion","BufferTextureCopy","texExtent","nullTexBuff","Uint8Array","size","fill","copyBuffersToTexture","texSubres","layerCount","destroy","removeEventListener","resize","surfaceTransform","event"],"mappings":";;;;;;;;;AAyBA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AACA;;AAhCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAWA,MAAMA,qBAAqB,GAAG,kBAA9B;;AAEA,SAASC,UAAT,CAAqBC,EAArB,EAAiD;AAC7CA,EAAAA,EAAE,CAACC,aAAH,CAAiBD,EAAE,CAACE,QAApB;AACAF,EAAAA,EAAE,CAACG,WAAH,CAAeH,EAAE,CAACI,cAAlB,EAAkC,CAAlC;AACAJ,EAAAA,EAAE,CAACG,WAAH,CAAeH,EAAE,CAACK,gBAAlB,EAAoC,CAApC;AACAL,EAAAA,EAAE,CAACG,WAAH,CAAeH,EAAE,CAACM,mBAAlB,EAAuC,KAAvC;AAEAN,EAAAA,EAAE,CAACO,eAAH,CAAmBP,EAAE,CAACQ,WAAtB,EAAmC,IAAnC,EAN6C,CAQ7C;;AACAR,EAAAA,EAAE,CAACS,MAAH,CAAUT,EAAE,CAACU,YAAb;AACAV,EAAAA,EAAE,CAACS,MAAH,CAAUT,EAAE,CAACW,SAAb;AACAX,EAAAA,EAAE,CAACY,QAAH,CAAYZ,EAAE,CAACa,IAAf;AACAb,EAAAA,EAAE,CAACc,SAAH,CAAad,EAAE,CAACe,GAAhB;AACAf,EAAAA,EAAE,CAACgB,aAAH,CAAiB,GAAjB,EAAsB,GAAtB,EAb6C,CAe7C;;AACAhB,EAAAA,EAAE,CAACS,MAAH,CAAUT,EAAE,CAACiB,UAAb;AACAjB,EAAAA,EAAE,CAACkB,SAAH,CAAa,IAAb;AACAlB,EAAAA,EAAE,CAACmB,SAAH,CAAanB,EAAE,CAACoB,IAAhB;AAEApB,EAAAA,EAAE,CAACqB,mBAAH,CAAuBrB,EAAE,CAACsB,KAA1B,EAAiCtB,EAAE,CAACuB,MAApC,EAA4C,CAA5C,EAA+C,MAA/C;AACAvB,EAAAA,EAAE,CAACwB,iBAAH,CAAqBxB,EAAE,CAACsB,KAAxB,EAA+BtB,EAAE,CAACyB,IAAlC,EAAwCzB,EAAE,CAACyB,IAA3C,EAAiDzB,EAAE,CAACyB,IAApD;AACAzB,EAAAA,EAAE,CAAC0B,mBAAH,CAAuB1B,EAAE,CAACsB,KAA1B,EAAiC,MAAjC;AACAtB,EAAAA,EAAE,CAACqB,mBAAH,CAAuBrB,EAAE,CAACa,IAA1B,EAAgCb,EAAE,CAACuB,MAAnC,EAA2C,CAA3C,EAA8C,MAA9C;AACAvB,EAAAA,EAAE,CAACwB,iBAAH,CAAqBxB,EAAE,CAACa,IAAxB,EAA8Bb,EAAE,CAACyB,IAAjC,EAAuCzB,EAAE,CAACyB,IAA1C,EAAgDzB,EAAE,CAACyB,IAAnD;AACAzB,EAAAA,EAAE,CAAC0B,mBAAH,CAAuB1B,EAAE,CAACa,IAA1B,EAAgC,MAAhC;AAEAb,EAAAA,EAAE,CAAC2B,OAAH,CAAW3B,EAAE,CAAC4B,YAAd,EA3B6C,CA6B7C;;AACA5B,EAAAA,EAAE,CAAC2B,OAAH,CAAW3B,EAAE,CAAC6B,wBAAd;AACA7B,EAAAA,EAAE,CAAC2B,OAAH,CAAW3B,EAAE,CAAC8B,KAAd;AACA9B,EAAAA,EAAE,CAAC+B,qBAAH,CAAyB/B,EAAE,CAACgC,QAA5B,EAAsChC,EAAE,CAACgC,QAAzC;AACAhC,EAAAA,EAAE,CAACiC,iBAAH,CAAqBjC,EAAE,CAACkC,GAAxB,EAA6BlC,EAAE,CAACmC,IAAhC,EAAsCnC,EAAE,CAACkC,GAAzC,EAA8ClC,EAAE,CAACmC,IAAjD;AACAnC,EAAAA,EAAE,CAACoC,SAAH,CAAa,IAAb,EAAmB,IAAnB,EAAyB,IAAzB,EAA+B,IAA/B;AACApC,EAAAA,EAAE,CAACqC,UAAH,CAAc,GAAd,EAAmB,GAAnB,EAAwB,GAAxB,EAA6B,GAA7B;AACH;;AAED,SAASC,YAAT,CAAuBtC,EAAvB,EAAmDuC,GAAnD,EAAqE;AACjE,QAAMC,QAAQ,GAAG,CAAC,EAAD,EAAK,SAAL,EAAgB,MAAhB,CAAjB;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,QAAQ,CAACE,MAA7B,EAAqC,EAAED,CAAvC,EAA0C;AACtC,UAAME,IAAI,GAAG3C,EAAE,CAACsC,YAAH,CAAgBE,QAAQ,CAACC,CAAD,CAAR,GAAcF,GAA9B,CAAb;;AACA,QAAII,IAAJ,EAAU;AACV;AACI,aAAOA,IAAP;AACH;AACJ;;AACD,SAAO,IAAP;AACH;;AAEM,SAASC,aAAT,CAAwB5C,EAAxB,EAAoD;AACvD,QAAM6C,GAAsB,GAAG;AAC3BC,IAAAA,8BAA8B,EAAER,YAAY,CAACtC,EAAD,EAAK,gCAAL,CADjB;AAE3B+C,IAAAA,2BAA2B,EAAET,YAAY,CAACtC,EAAD,EAAK,6BAAL,CAFd;AAG3BgD,IAAAA,sBAAsB,EAAEV,YAAY,CAACtC,EAAD,EAAK,wBAAL,CAHT;AAI3BiD,IAAAA,gBAAgB,EAAEX,YAAY,CAACtC,EAAD,EAAK,kBAAL,CAJH;AAK3BkD,IAAAA,6BAA6B,EAAEZ,YAAY,CAACtC,EAAD,EAAK,+BAAL,CALhB;AAM3BmD,IAAAA,4BAA4B,EAAEb,YAAY,CAACtC,EAAD,EAAK,8BAAL,CANf;AAO3BoD,IAAAA,8BAA8B,EAAEd,YAAY,CAACtC,EAAD,EAAK,gCAAL,CAPjB;AAQ3BqD,IAAAA,6BAA6B,EAAEf,YAAY,CAACtC,EAAD,EAAK,+BAAL,CARhB;AAS3BsD,IAAAA,6BAA6B,EAAEhB,YAAY,CAACtC,EAAD,EAAK,+BAAL,CAThB;AAU3BuD,IAAAA,kCAAkC,EAAEjB,YAAY,CAACtC,EAAD,EAAK,oCAAL,CAVrB;AAW3BwD,IAAAA,mBAAmB,EAAElB,YAAY,CAACtC,EAAD,EAAK,qBAAL,CAXN;AAY3ByD,IAAAA,kBAAkB,EAAEnB,YAAY,CAACtC,EAAD,EAAK,oBAAL,CAZL;AAa3B0D,IAAAA,yBAAyB,EAAEpB,YAAY,CAACtC,EAAD,EAAK,2BAAL,CAbZ;AAc3B2D,IAAAA,6BAA6B,EAAErB,YAAY,CAACtC,EAAD,EAAK,+BAAL,CAdhB;AAe3B4D,IAAAA,wBAAwB,EAAEtB,YAAY,CAACtC,EAAD,EAAK,0BAAL,CAfX;AAgB3B6D,IAAAA,MAAM,EAAE;AAhBmB,GAA/B;AAmBA,SAAOhB,GAAP;AACH;;AAEM,SAASiB,UAAT,CAAqBC,MAArB,EAA+E;AAClF,MAAIC,OAAsC,GAAG,IAA7C;;AACA,MAAI;AACA,UAAMC,eAAuC,GAAG;AAC5CC,MAAAA,KAAK,EAAEC,aAAMC,yBAD+B;AAE5CC,MAAAA,SAAS,EAAEC,iCAAUH,aAAMI,sBAFiB;AAG5CC,MAAAA,KAAK,EAAE,IAHqC;AAI5CC,MAAAA,OAAO,EAAE,IAJmC;AAK5CC,MAAAA,kBAAkB,EAAE,KALwB;AAM5CC,MAAAA,qBAAqB,EAAE,KANqB;AAO5CC,MAAAA,eAAe,EAAE,SAP2B;AAQ5CC,MAAAA,4BAA4B,EAAE;AARc,KAAhD;AAWAb,IAAAA,OAAO,GAAGD,MAAM,CAACD,UAAP,CAAkB,QAAlB,EAA4BG,eAA5B,CAAV;AACH,GAbD,CAaE,OAAOa,GAAP,EAAY;AACV,WAAO,IAAP;AACH;;AAED,SAAOd,OAAP;AACH;;AAEM,MAAMe,eAAN,SAA8BC,oBAA9B,CAAwC;AAAA;AAAA;AAAA,SAKpCC,UALoC,GAKL,IAAIC,kCAAJ,EALK;AAAA,SAMpCC,SANoC,GAMT,IANS;AAAA,SAOpCC,WAPoC,GAOP,IAPO;AAAA,SASnCC,OATmC,GASC,IATD;AAAA,SAUnCC,yBAVmC,GAU0B,IAV1B;AAAA,SAWnCC,WAXmC,GAWK,IAXL;AAAA;;AAC7B,MAAVC,UAAU,GAAI;AACd,WAAO,KAAKD,WAAZ;AACH;;AAUME,EAAAA,UAAU,CAAEC,IAAF,EAAuB;AACpC,SAAKL,OAAL,GAAeK,IAAI,CAACC,YAApB;AAEA,SAAKL,yBAAL,GAAiC,KAAKM,mBAAL,CAAyBC,IAAzB,CAA8B,IAA9B,CAAjC;;AACA,SAAKR,OAAL,CAAaS,gBAAb,CAA8BhG,qBAA9B,EAAqD,KAAK8F,mBAA1D;;AAEA,UAAM5F,EAAE,GAAG+F,kCAAoBC,QAApB,CAA6BhG,EAAxC;AAEA,SAAKiF,UAAL,CAAgBQ,UAAhB,CACIM,kCAAoBC,QAApB,CAA6BC,YAA7B,CAA0CC,eAD9C,EAEIH,kCAAoBC,QAApB,CAA6BC,YAA7B,CAA0CE,wBAF9C,EAGIJ,kCAAoBC,QAApB,CAA6BC,YAA7B,CAA0CG,mBAH9C;AAMA,SAAKb,WAAL,GAAmB3C,aAAa,CAAC5C,EAAD,CAAhC,CAdoC,CAgBpC;;AACAD,IAAAA,UAAU,CAACC,EAAD,CAAV;AAEA,UAAMqG,QAAQ,GAAGC,eAAOC,KAAxB;AACA,QAAIC,eAAe,GAAGF,eAAOG,aAA7B;AAEA,UAAMC,SAAS,GAAG1G,EAAE,CAAC2G,YAAH,CAAgB3G,EAAE,CAAC4G,UAAnB,CAAlB;AACA,UAAMC,WAAW,GAAG7G,EAAE,CAAC2G,YAAH,CAAgB3G,EAAE,CAAC8G,YAAnB,CAApB;AAEA,QAAIJ,SAAS,IAAIG,WAAjB,EAA8BL,eAAe,GAAGF,eAAOG,aAAzB,CAA9B,KACK,IAAIC,SAAJ,EAAeF,eAAe,GAAGF,eAAOS,KAAzB;AAEpB,SAAKC,aAAL,GAAqB,IAAIC,4BAAJ,EAArB,CA5BoC,CA6BpC;;AACA,SAAKD,aAAL,CAAmBE,sBAAnB,CAA0C;AACtCC,MAAAA,SAAS,EAAE,IAD2B;AAEtCC,MAAAA,MAAM,EAAEf,QAF8B;AAGtCgB,MAAAA,KAAK,EAAE3B,IAAI,CAAC2B,KAH0B;AAItCC,MAAAA,MAAM,EAAE5B,IAAI,CAAC4B;AAJyB,KAA1C;;AAOA,SAAKC,oBAAL,GAA4B,IAAIN,4BAAJ,EAA5B,CArCoC,CAsCpC;;AACA,SAAKM,oBAAL,CAA0BL,sBAA1B,CAAiD;AAC7CC,MAAAA,SAAS,EAAE,IADkC;AAE7CC,MAAAA,MAAM,EAAEZ,eAFqC;AAG7Ca,MAAAA,KAAK,EAAE3B,IAAI,CAAC2B,KAHiC;AAI7CC,MAAAA,MAAM,EAAE5B,IAAI,CAAC4B;AAJgC,KAAjD,EAvCoC,CA8CpC;;;AACA,SAAKnC,SAAL,GAAiBY,kCAAoBC,QAApB,CAA6BwB,aAA7B,CAA2C,IAAIC,mBAAJ,CACxDC,oBAAYC,KAD4C,EAExDC,wBAAgBC,OAFwC,EAGxDvB,eAAOC,KAHiD,EAIxD,CAJwD,EAKxD,CALwD,EAMxDuB,uBAAeC,IANyC,CAA3C,CAAjB;AASA,SAAK3C,WAAL,GAAmBW,kCAAoBC,QAApB,CAA6BwB,aAA7B,CAA2C,IAAIC,mBAAJ,CAC1DC,oBAAYM,IAD8C,EAE1DJ,wBAAgBC,OAF0C,EAG1DvB,eAAOC,KAHmD,EAI1D,CAJ0D,EAK1D,CAL0D,EAM1DuB,uBAAeC,IAN2C,EAO1D,CAP0D,CAA3C,CAAnB;AAUA,UAAME,aAAa,GAAG,IAAIC,yBAAJ,EAAtB;AACAD,IAAAA,aAAa,CAACE,SAAd,CAAwBd,KAAxB,GAAgC,CAAhC;AACAY,IAAAA,aAAa,CAACE,SAAd,CAAwBb,MAAxB,GAAiC,CAAjC;AAEA,UAAMc,WAAW,GAAG,IAAIC,UAAJ,CAAe,KAAKlD,SAAL,CAAemD,IAA9B,CAApB;AACAF,IAAAA,WAAW,CAACG,IAAZ,CAAiB,CAAjB;;AACAxC,sCAAoBC,QAApB,CAA6BwC,oBAA7B,CAAkD,CAACJ,WAAD,CAAlD,EAAiE,KAAKjD,SAAtE,EAAiF,CAAC8C,aAAD,CAAjF;;AAEAA,IAAAA,aAAa,CAACQ,SAAd,CAAwBC,UAAxB,GAAqC,CAArC;;AACA3C,sCAAoBC,QAApB,CAA6BwC,oBAA7B,CACI,CAACJ,WAAD,EAAcA,WAAd,EAA2BA,WAA3B,EAAwCA,WAAxC,EAAqDA,WAArD,EAAkEA,WAAlE,CADJ,EAEI,KAAKhD,WAFT,EAEsB,CAAC6C,aAAD,CAFtB;AAIH;;AAEMU,EAAAA,OAAO,GAAU;AACpB,QAAI,KAAKtD,OAAL,IAAgB,KAAKC,yBAAzB,EAAoD;AAChD,WAAKD,OAAL,CAAauD,mBAAb,CAAiC9I,qBAAjC,EAAwD,KAAKwF,yBAA7D;;AACA,WAAKA,yBAAL,GAAiC,IAAjC;AACH;;AAED,QAAI,KAAKH,SAAT,EAAoB;AAChB,WAAKA,SAAL,CAAewD,OAAf;AACA,WAAKxD,SAAL,GAAiB,IAAjB;AACH;;AAED,QAAI,KAAKC,WAAT,EAAsB;AAClB,WAAKA,WAAL,CAAiBuD,OAAjB;AACA,WAAKvD,WAAL,GAAmB,IAAnB;AACH;;AAED,SAAKG,WAAL,GAAmB,IAAnB;AACA,SAAKF,OAAL,GAAe,IAAf;AACH;;AAEMwD,EAAAA,MAAM,CAAExB,KAAF,EAAiBC,MAAjB,EAAiCwB,gBAAjC,EAAqE;AAC9E,QAAI,KAAK9B,aAAL,CAAmBK,KAAnB,KAA6BA,KAA7B,IAAsC,KAAKL,aAAL,CAAmBM,MAAnB,KAA8BA,MAAxE,EAAgF;AAC5E,wBAAO,uBAAsBD,KAAM,IAAGC,MAAO,EAA7C;AACA,WAAKjC,OAAL,CAAcgC,KAAd,GAAsBA,KAAtB;AACA,WAAKhC,OAAL,CAAciC,MAAd,GAAuBA,MAAvB;;AACA,WAAKN,aAAL,CAAmB6B,MAAnB,CAA0BxB,KAA1B,EAAiCC,MAAjC;;AACA,WAAKC,oBAAL,CAA0BsB,MAA1B,CAAiCxB,KAAjC,EAAwCC,MAAxC;AACH;AACJ;;AAEO1B,EAAAA,mBAAmB,CAAEmD,KAAF,EAAgB;AACvC,uBAAO,KAAP;AACA,qBAAKA,KAAL,EAFuC,CAGvC;AACA;AACH;;AAjI0C"}
{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/assets/image-asset.ts"],"names":["isImageBitmap","imageSource","legacyCC","sys","hasFeature","Feature","IMAGE_BITMAP","ImageBitmap","fetchImageSource","_data","isNativeImage","ALIPAY","XIAOMI","BAIDU","JSB","_compressed","HTMLImageElement","HTMLCanvasElement","ImageAsset","Asset","_nativeAsset","_nativeData","value","HTMLElement","format","_format","reset","data","width","_width","height","_height","isCompressed","PixelFormat","RGB_ETC1","RGBA_ASTC_12x12","RGB_A_PVRTC_2BPPV1","RGBA_ETC1","url","nativeUrl","constructor","nativeAsset","_exportedExts","undefined","RGBA8888","EDITOR","destroy","src","_setRawAsset","close","_serialize","TEST","targetExtensions","_native","extensionIndices","targetExtension","extensionFormat","split","i","extnames","indexOf","exportedExtensionID","push","fmt","join","w","h","_deserialize","fmtStr","device","_getGlobalDevice","extensionIDs","preferedExtensionIndex","Number","MAX_VALUE","ext","SupportTextureFormats","macro","SUPPORT_TEXTURE_FORMATS","extensionID","extFormat","parseInt","tmpExt","index","FORMAT_ASTC","FORMAT_PVRTC","FORMAT_ETC1","RGB_ETC2","RGBA_ETC2","FORMAT_ETC2","WEBP","initDefault","uuid","_sharedPlaceHolderCanvas","canvas","document","createElement","context","getContext","l","fillStyle","fillRect","validate","override","director","root"],"mappings":"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"}
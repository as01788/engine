{"version":3,"sources":["file:///Users/disstian/Documents/CreatorProjects/engine3.3.0/cocos/core/animation/kinematics/ccd.ts"],"names":["THETA_ERROR","DUMP_BIAS","IterationResult","ccdIK","links","target","epsilon","maxIterations","forward","nLinks","length","u","Vec3","v","axis","correctiveRot","Quat","currentPos","currentRot","endFactorPos","iEndFactor","endFactor","iteration","iLink","result","correct","INTERRUPTED","DONE","linkIndex","current","getWorldPosition","subtract","normalize","cross","cosTheta","dot","theta","Math","acos","fromAxisAngle","getWorldRotation","multiply","setWorldRotation","distance","UNFINISHED"],"mappings":";;;;;;;AAEA;;AAEA;;AAGA,MAAMA,WAAW,GAAG,KAApB;AACA,MAAMC,SAAS,GAAG,GAAlB;IAEKC,e;AAML;AACA;AACA;AACA;AACA;AACA;AACA;;WAZKA,e;AAAAA,EAAAA,e,CAAAA,e;AAAAA,EAAAA,e,CAAAA,e;AAAAA,EAAAA,e,CAAAA,e;GAAAA,e,KAAAA,e;;AAaE,SAASC,KAAT,CACHC,KADG,EAEHC,MAFG,EAGHC,OAHG,EAIHC,aAJG,EAKHC,OALG,EAML;AACE,QAAMC,MAAM,GAAGL,KAAK,CAACM,MAArB;;AACA,MAAID,MAAM,GAAG,CAAb,EAAgB;AACZ;AACH;;AAED,QAAME,CAAC,GAAG,IAAIC,SAAJ,EAAV,CANF,CAMwB;;AACtB,QAAMC,CAAC,GAAG,IAAID,SAAJ,EAAV,CAPF,CAOwB;;AACtB,QAAME,IAAI,GAAG,IAAIF,SAAJ,EAAb,CARF,CAQ2B;;AACzB,QAAMG,aAAa,GAAG,IAAIC,UAAJ,EAAtB;AACA,QAAMC,UAAU,GAAG,IAAIL,SAAJ,EAAnB;AACA,QAAMM,UAAU,GAAG,IAAIF,UAAJ,EAAnB;AACA,QAAMG,YAAY,GAAG,IAAIP,SAAJ,EAArB;AAEA,QAAMQ,UAAU,GAAGhB,KAAK,CAACM,MAAN,GAAe,CAAlC;AACA,QAAMW,SAAS,GAAGjB,KAAK,CAACgB,UAAD,CAAvB;;AACA,MAAIZ,OAAJ,EAAa;AACT,SAAK,IAAIc,SAAS,GAAG,CAArB,EAAwBA,SAAS,GAAGf,aAApC,EAAmD,EAAEe,SAArD,EAAgE;AAC5D;AACA,WAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGH,UAA5B,EAAwC,EAAEG,KAA1C,EAAiD;AAC7C,cAAMC,MAAM,GAAGC,OAAO,CAACF,KAAD,CAAtB;;AACA,YAAIC,MAAM,KAAKtB,eAAe,CAACwB,WAA/B,EAA4C;AACxC;AACH,SAFD,MAEO,IAAIF,MAAM,KAAKtB,eAAe,CAACyB,IAA/B,EAAqC;AACxC;AACH;AACJ;AACJ;AACJ,GAZD,MAYO;AACH,SAAK,IAAIL,SAAS,GAAG,CAArB,EAAwBA,SAAS,GAAGf,aAApC,EAAmD,EAAEe,SAArD,EAAgE;AAC5D;AACA,WAAK,IAAIC,KAAK,GAAGH,UAAU,GAAG,CAA9B,EAAiCG,KAAK,IAAI,CAA1C,EAA6C,EAAEA,KAA/C,EAAsD;AAClD,cAAMC,MAAM,GAAGC,OAAO,CAACF,KAAD,CAAtB;;AACA,YAAIC,MAAM,KAAKtB,eAAe,CAACwB,WAA/B,EAA4C;AACxC;AACH,SAFD,MAEO,IAAIF,MAAM,KAAKtB,eAAe,CAACyB,IAA/B,EAAqC;AACxC;AACH;AACJ;AACJ;AACJ;;AAED,WAASF,OAAT,CAAkBG,SAAlB,EAAsD;AAClD,UAAMC,OAAO,GAAGzB,KAAK,CAACwB,SAAD,CAArB;AAEAC,IAAAA,OAAO,CAACC,gBAAR,CAAyBb,UAAzB;AACAI,IAAAA,SAAS,CAACS,gBAAV,CAA2BX,YAA3B;;AAEAP,cAAKmB,QAAL,CAAcpB,CAAd,EAAiBQ,YAAjB,EAA+BF,UAA/B;;AACAL,cAAKoB,SAAL,CAAerB,CAAf,EAAkBA,CAAlB;;AACAC,cAAKmB,QAAL,CAAclB,CAAd,EAAiBR,MAAjB,EAAyBY,UAAzB;;AACAL,cAAKoB,SAAL,CAAenB,CAAf,EAAkBA,CAAlB,EATkD,CAWlD;;;AACAD,cAAKqB,KAAL,CAAWnB,IAAX,EAAiBH,CAAjB,EAAoBE,CAApB;;AACAD,cAAKoB,SAAL,CAAelB,IAAf,EAAqBA,IAArB;;AAEA,UAAMoB,QAAQ,GAAGtB,UAAKuB,GAAL,CAASxB,CAAT,EAAYE,CAAZ,CAAjB;;AACA,UAAMuB,KAAK,GAAGC,IAAI,CAACC,IAAL,CAAUJ,QAAV,IAAsBjC,SAApC,CAhBkD,CAkBlD;;AACAe,eAAKuB,aAAL,CAAmBxB,aAAnB,EAAkCD,IAAlC,EAAwCsB,KAAxC;;AACAP,IAAAA,OAAO,CAACW,gBAAR,CAAyBtB,UAAzB;;AACAF,eAAKyB,QAAL,CAAcvB,UAAd,EAA0BH,aAA1B,EAAyCG,UAAzC;;AACAW,IAAAA,OAAO,CAACa,gBAAR,CAAyBxB,UAAzB;AACAG,IAAAA,SAAS,CAACS,gBAAV,CAA2BX,YAA3B,EAvBkD,CAyBlD;;AACA,UAAMwB,QAAQ,GAAG/B,UAAK+B,QAAL,CAAcxB,YAAd,EAA4Bd,MAA5B,CAAjB;;AACA,QAAIsC,QAAQ,GAAGrC,OAAf,EAAwB;AACpB,aAAOJ,eAAe,CAACyB,IAAvB;AACH,KA7BiD,CA+BlD;;;AACA,QAAIS,KAAK,GAAGpC,WAAZ,EAAyB;AACrB,aAAOE,eAAe,CAACwB,WAAvB;AACH;;AAED,WAAOxB,eAAe,CAAC0C,UAAvB;AACH;AACJ"}
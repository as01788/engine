{"version":3,"sources":["../../../../../../../../cocos/particle-2d/motion-streak-2d-assembler.ts"],"names":["normal","out","dir","x","y","computeMiter","miter","lineA","lineB","halfThick","maxMultiple","add","_tangent","normalize","_vec2","multiple","dot","Math","min","MotionStreak","Vec2","Color","_normal","MotionStreakAssembler","createData","comp","renderData","requestRenderData","dataLength","vertexCount","indicesCount","update","dt","stroke","node","matrix","worldMatrix","tx","m12","ty","m13","points","cur","length","point","difx","dify","minSeg","Point","unshift","setPoint","time","fadeTime","verticesCount","updateRenderDataCache","color","cr","r","cg","g","cb","b","ca","a","prev","distance","subtract","setDir","data","findLast","i","p","splice","progress","next","da","c","offset","u","v","_val","passDirty","updatePass","nodeDirty","updateNode","textureDirty","texture","updateTexture","material","getRenderMaterial","hashDirty","updateHash","updateRenderData","fillBuffers","renderer","dataList","buffer","acquireBufferBatch","vertexOffset","byteOffset","indicesOffset","vertexId","isRecreate","request","currBufferBatch","vBuf","vData","iBuf","iData","vert","z","toArray","l","start","MotionStreakAssemblerManager","getAssembler","Assembler"],"mappings":"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"}
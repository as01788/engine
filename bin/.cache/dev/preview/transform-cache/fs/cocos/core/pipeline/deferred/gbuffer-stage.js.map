{"version":3,"sources":["../../../../../../../../../../cocos/core/pipeline/deferred/gbuffer-stage.ts"],"names":["ccclass","displayOrder","type","serializable","SetIndex","getPhaseID","renderQueueClearFunc","convertRenderQueue","renderQueueSortFunc","ClearFlagBit","Color","Rect","SRGBToLinear","RenderBatchedQueue","RenderInstancedQueue","RenderStage","DeferredStagePriority","BatchingSchemes","RenderQueueDesc","RenderQueueSortMode","colors","GbufferStage","_renderQueues","_renderArea","_batchedQueue","_instancedQueue","_phaseID","initialize","info","renderQueues","activate","pipeline","flow","i","length","destroy","render","camera","clear","_pipeline","device","forEach","generateRenderArea","updateQuadVertexData","window","renderObjects","pipelineSceneData","m","p","k","ro","subModels","model","subModel","passes","pass","phase","batchingScheme","INSTANCING","instancedBuffer","getInstancedBuffer","merge","instancedAttributes","queue","add","VB_MERGING","batchedBuffer","getBatchedBuffer","insertRenderPass","cmdBuff","commandBuffers","uploadBuffers","clearFlag","COLOR","isHDR","clearColor","x","y","z","w","deferredData","getPipelineRenderData","framebuffer","gbufferFrameBuffer","renderPass","beginRenderPass","clearDepth","clearStencil","setScissor","generateScissor","setViewport","generateViewport","bindDescriptorSet","GLOBAL","descriptorSet","recordCommandBuffer","endRenderPass","initInfo","name","priority","GBUFFER","tag","isTransparent","sortMode","FRONT_TO_BACK","stages","BACK_TO_FRONT"],"mappings":"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"}
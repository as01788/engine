{"version":3,"sources":["../../../../../../../../../../cocos/core/renderer/scene/spot-light.ts"],"names":["JSB","AABB","Frustum","legacyCC","Mat4","Quat","Vec3","Light","LightType","nt2lm","_forward","_qt","_matView","_matProj","_matViewProj","_matViewProjInv","SpotLight","_init","nativeSpotLight","_nativeObj","setAABB","_aabb","setFrustum","_frustum","setDirection","_dir","setPosition","_pos","_destroy","_setDirection","dir","set","_range","_spotAngle","Math","cos","PI","_angle","_needUpdate","_size","_luminanceHDR","_luminanceLDR","_aspect","create","_type","SPOT","initialize","size","aspect","luminance","luminanceLDR","range","update","_node","hasChangedFlags","getWorldPosition","transformQuat","getWorldRotation","normalize","x","y","z","getWorldRT","invert","perspective","multiply","setSize","setRange","isHDR","director","root","pipeline","pipelineSceneData","value","luminanceHDR","setLuminanceHDR","setLuminanceLDR","val","setAngle","setAspect"],"mappings":"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"}
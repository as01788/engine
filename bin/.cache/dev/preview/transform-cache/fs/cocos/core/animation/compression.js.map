{"version":3,"sources":["../../../../../../../../../cocos/core/animation/compression.ts"],"names":["removeLinearKeys","keys","values","maxDiff","nKeys","length","slice","removeFlags","Array","fill","iLastKey","iKey","iPrevious","iNext","previousKey","currentKey","nextKey","previousValue","currentValue","nextValue","alpha","expectedValue","approx","filterFromRemoveFlags","removeTrivialKeys","nRemovals","reduce","n","removeFlag","nNewKeyframes","newKeys","newValues","iNewKeys"],"mappings":"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"}
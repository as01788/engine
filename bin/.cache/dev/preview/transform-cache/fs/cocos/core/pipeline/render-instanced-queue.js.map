{"version":3,"sources":["../../../../../../../../../cocos/core/pipeline/render-instanced-queue.ts"],"names":["PipelineStateManager","SetIndex","RenderInstancedQueue","queue","Set","clear","it","values","res","next","done","value","uploadBuffers","cmdBuff","hasPendingModels","recordCommandBuffer","device","renderPass","instances","pass","bindDescriptorSet","MATERIAL","descriptorSet","lastPSO","b","length","instance","count","shader","pso","getOrCreatePipelineState","ia","bindPipelineState","LOCAL","dynamicOffsets","bindInputAssembler","draw"],"mappings":"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"}
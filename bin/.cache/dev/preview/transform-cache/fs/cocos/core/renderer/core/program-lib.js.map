{"version":3,"sources":["../../../../../../../../../../cocos/core/renderer/core/program-lib.ts"],"names":["getBitCount","cnt","Math","ceil","log2","max","mapDefine","info","def","type","toString","undefined","options","range","console","warn","prepareDefines","defs","tDefs","macros","i","length","tmpl","name","v","value","isDefault","push","getShaderInstanceName","reduce","acc","cur","insertBuiltinBindings","tmplInfo","source","outBindings","target","builtins","tempBlocks","b","blocks","layouts","binding","bindings","find","bd","descriptorType","DESCRIPTOR_BUFFER_TYPE","includes","Array","prototype","unshift","apply","shaderInfo","tempSamplerTextures","s","samplerTextures","DESCRIPTOR_SAMPLER_TYPE","sort","a","getSize","block","members","m","GetTypeSize","count","genHandles","handleMap","offset","j","uniform","genHandle","samplerTexture","dependencyCheck","dependencies","defines","d","slice","getActiveAttributes","out","attributes","gfxAttributes","getDeviceShaderVersion","device","gfxAPI","API","GLES2","WEBGL","GLES3","WEBGL2","SetIndex","globalDescriptorSetLayout","localDescriptorSetLayout","legacyCC","PipelineLayoutInfo","Attribute","UniformBlock","ShaderInfo","Uniform","ShaderStage","DescriptorSetLayoutBinding","DescriptorSetLayoutInfo","DescriptorType","ShaderStageFlagBit","UniformSamplerTexture","UniformStorageBuffer","UniformStorageImage","UniformSampler","UniformTexture","UniformInputAttachment","debug","_dsLayoutInfo","ProgramLib","_templates","_cache","_templateInfos","register","effect","shaders","define","effectName","techniques","tech","passes","pass","propertyIndex","properties","shader","curTmpl","hash","_map","findIndex","_offset","uber","constantMacros","key","statistics","samplerStartBinding","blockSizes","UNIFORM_BUFFER","stageFlags","MATERIAL","map","SAMPLER_TEXTURE","samplers","sampler","SAMPLER","textures","texture","TEXTURE","buffers","buffer","STORAGE_BUFFER","memoryAccess","images","image","STORAGE_IMAGE","subpassInputs","subpassInput","INPUT_ATTACHMENT","attr","format","isNormalized","isInstanced","location","stages","VERTEX","FRAGMENT","setLayouts","getTemplate","getTemplateInfo","getDescriptorSetLayout","isLocal","createDescriptorSetLayout","LOCAL","hasProgram","getKey","tmplDefs","tmplDef","mapped","destroyShaderByDefines","names","Object","keys","regexes","val","RegExp","filter","k","every","re","test","prog","destroy","getGFXShader","pipeline","assign","res","pipelineLayout","GLOBAL","descriptorSetLayout","createPipelineLayout","macroArray","prefix","src","glsl3","deviceShaderVersion","error","vert","frag","createShader","programLib"],"mappings":"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"}
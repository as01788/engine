{"version":3,"sources":["../../../../../../../../../cocos/core/geometry/curve.ts"],"names":["evalOptCurve","t","coefs","fromLegacyWrapMode","legacyWrapMode","WrapModeMask","Default","Normal","Clamp","ExtrapolationMode","CLAMP","PingPong","PING_PONG","Loop","LOOP","toLegacyWrapMode","extrapolationMode","LINEAR","constructLegacyCurveAndConvert","curve","RealCurve","assignSorted","interpolationMode","RealInterpolationMode","CUBIC","value","CCClass","clamp","pingPong","repeat","ccclass","serializable","LOOK_FORWARD","Keyframe","time","inTangent","outTangent","fastDefine","OptimizedKey","index","endTime","coefficient","Float32Array","evaluate","T","AnimationCurve","keyFrames","cachedKey","_curve","preExtrapolation","postExtrapolation","map","legacyKeyframe","leftTangent","rightTangent","addKey","keyFrame","clear","addKeyFrame","evaluate_slow","nKeyframes","keyFramesCount","lastKeyframeIndex","wrappedTime","startTime","getKeyframeTime","leftIndex","findIndex","rightIndex","Math","min","calcOptimizedKey","optKey","lhsTime","rhsTime","getKeyframeValue","lhsValue","lhsOutTangent","rhsValue","rhsInTangent","dx","dy","length","d1","d2","cachedIndex","cachedTime","i","currIndex","left","right","mid","floor","Array","from","keyframes","legacyCurve","defaultKF"],"mappings":"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"}
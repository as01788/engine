{"version":3,"sources":["../../../../../../../../../cocos/core/assets/image-asset.ts"],"names":["isImageBitmap","imageSource","legacyCC","sys","hasFeature","Feature","IMAGE_BITMAP","ImageBitmap","fetchImageSource","_data","isNativeImage","ALIPAY","XIAOMI","BAIDU","JSB","_compressed","HTMLImageElement","HTMLCanvasElement","_getGlobalDevice","director","root","device","ccclass","override","EDITOR","TEST","Asset","PixelFormat","warnID","ImageAsset","nativeAsset","_nativeData","_exportedExts","undefined","_format","RGBA8888","_width","_height","width","height","format","reset","data","HTMLElement","destroy","src","_setRawAsset","close","_serialize","targetExtensions","_native","extensionIndices","targetExtension","extensionFormat","split","i","extnames","indexOf","exportedExtensionID","push","fmt","join","w","h","_deserialize","fmtStr","extensionIDs","preferedExtensionIndex","Number","MAX_VALUE","ext","SupportTextureFormats","macro","SUPPORT_TEXTURE_FORMATS","extensionID","extFormat","parseInt","tmpExt","index","FORMAT_ASTC","FORMAT_PVRTC","RGB_ETC1","RGBA_ETC1","FORMAT_ETC1","RGB_ETC2","RGBA_ETC2","FORMAT_ETC2","WEBP","initDefault","uuid","_sharedPlaceHolderCanvas","canvas","document","createElement","context","getContext","l","fillStyle","fillRect","validate","value","RGBA_ASTC_12x12","RGB_A_PVRTC_2BPPV1","nativeUrl"],"mappings":"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"}
{"version":3,"sources":["../../../../../../../../../../cocos/core/renderer/scene/render-scene.ts"],"names":["JSB","ModelType","TransformBit","NativeRenderScene","RenderScene","registerCreateFunc","root","_createSceneFun","_root","_name","_cameras","_models","_batches","_directionalLights","_sphereLights","_spotLights","_mainLight","_modelId","_createNativeObject","initialize","info","name","activate","_nativeObj","update","stamp","nativeBatches","i","len","length","push","updateBatches","mainLight","sphereLights","light","spotLights","models","model","enabled","updateTransform","updateUBOs","_destroy","destroy","removeCameras","removeSphereLights","removeSpotLights","removeModels","addCamera","cam","attachToScene","removeCamera","camera","splice","detachFromScene","setMainLight","dl","unsetMainLight","dlList","node","hasChangedFlags","ROTATION","addDirectionalLight","removeDirectionalLight","addSphereLight","pl","removeSphereLight","addSpotLight","sl","removeSpotLight","addModel","m","type","SKINNING","addSkinningModel","BAKED_SKINNING","addBakedSkinningModel","DEFAULT","removeModel","addBatch","batch","removeBatch","removeBatches","onGlobalPipelineStateChanged","generateModelId"],"mappings":"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"}
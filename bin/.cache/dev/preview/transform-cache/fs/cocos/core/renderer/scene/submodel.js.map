{"version":3,"sources":["../../../../../../../../../../cocos/core/renderer/scene/submodel.ts"],"names":["JSB","RenderPriority","UNIFORM_REFLECTION_TEXTURE_BINDING","UNIFORM_REFLECTION_STORAGE_BINDING","BatchingSchemes","DescriptorSetInfo","TextureType","TextureUsageBit","TextureInfo","Format","Filter","Address","SamplerInfo","legacyCC","errorID","NativeSubModel","getPhaseID","_dsInfo","MAX_PASS_COUNT","SubModel","_device","_passes","_shaders","_subMesh","_patches","_priority","DEFAULT","_inputAssembler","_descriptorSet","_worldBoundDescriptorSet","_planarInstanceShader","_planarShader","_reflectionTex","_reflectionSampler","_destroyDescriptorSet","destroy","_nativeObj","setDescriptorSet","_destroyWorldBoundDescriptorSet","setWorldBoundDescriptorSet","_destroyInputAssembler","setInputAssembler","_createDescriptorSet","descInfo","createDescriptorSet","_createWorldBoundDescriptorSet","_setInputAssembler","iaInfo","createInputAssembler","_setSubMesh","subMesh","setSubMeshBuffers","flatBuffers","_init","initialize","passes","patches","root","director","device","layout","localSetLayout","pipeline","occlusionPass","pipelineSceneData","getOcclusionQueryPass","occlusionDSInfo","_flushPassInfo","batchingScheme","VB_MERGING","genFlatBuffers","priority","phase","texWidth","mainWindow","width","texHeight","height","minSize","createTexture","TEX2D","STORAGE","TRANSFER_SRC","SAMPLED","RGBA8","descriptorSet","bindTexture","getSampler","LINEAR","NONE","CLAMP","bindSampler","_initNativePlanarShadowShader","shadowInfo","getPlanarShader","setPlanarShader","initPlanarShadowShader","shadows","_initNativePlanarShadowInstanceShader","getPlanarInstanceShader","setPlanarInstanceShader","initPlanarShadowInstanceShader","_destroy","update","i","length","pass","onPipelineStateChanged","beginChangeStatesSilently","tryCompile","endChangeStatesSilently","onMacroPatchesStateChanged","len","getShaderVariant","passesNative","map","_pass","setPasses","setShaders","passLengh","val","setPriority"],"mappings":"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"}
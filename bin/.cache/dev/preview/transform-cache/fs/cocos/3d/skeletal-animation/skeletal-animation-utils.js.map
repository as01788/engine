{"version":3,"sources":["../../../../../../../../../cocos/3d/skeletal-animation/skeletal-animation-utils.ts"],"names":["selectJointsMediumFormat","device","hasFeature","Feature","TEXTURE_FLOAT","Format","RGBA32F","RGBA8","uploadJointDataLBS","out","base","mat","firstBone","m00","m01","m02","m12","m04","m05","m06","m13","m08","m09","m10","m14","uploadJointDataDQS","Mat4","toRTS","qt_1","v3_1","v3_2","Quat","copy","dq_0","dot","multiplyScalar","set","dq_1","x","y","z","multiply","w","roundUpTextureSize","targetLength","formatSize","formatScale","Math","sqrt","ceil","max","MINIMUM_JOINT_TEXTURE_SIZE","EDITOR","JSB","SkelAnimDataHub","getWorldTransformUntilRoot","AABB","Address","BufferUsageBit","Filter","FormatInfos","MemoryUsageBit","BufferInfo","SamplerInfo","Vec3","UBOSkinningAnimation","TextureBufferPool","uploadJointData","jointTextureSamplerInfo","POINT","NONE","CLAMP","v3_3","v3_4","v3_min","v3_max","m4_1","m4_2","ab_1","Inf","Number","MAX_SAFE_INTEGER","JointTexturePool","_device","_pool","_textureBuffers","Map","_formatSize","_pixelsPerJoint","_customPool","_chunkIdxMap","format","size","initialize","roundUpFn","clear","destroy","registerCustomTextureLayouts","layouts","i","length","layout","chunkIdx","createChunk","textureLength","j","contents","content","skeleton","k","clips","clip","getDefaultPoseTexture","mesh","skinningRoot","hash","texture","get","bounds","has","refCount","joints","bindposes","textureBuffer","buildTexture","jointCount","bufSize","customChunkIdx","handle","undefined","alloc","Float32Array","BYTES_PER_ELEMENT","pixelOffset","start","skeletonHash","clipHash","readyToBeDeleted","boneSpaceBounds","getBoneSpaceBounds","offset","node","getChildByPath","inverseBindposes","bound","transform","getBoundary","min","IDENTITY","fromPoints","update","buffer","getSequencePoseTexture","clipData","getOrExtract","frames","animInfos","_createAnimInfos","f","push","curveData","downstream","bindposeIdx","bindposeCorrection","transformValid","boneSpaceBound","center","halfExtents","releaseHandle","free","releaseSkeleton","it","values","res","next","done","value","releaseAnimationClip","animPath","source","animNode","correctionPath","idx","lastIndexOf","substring","fromRTS","rotation","position","scale","parent","t","transforms","JointAnimationInfo","getData","nodeID","createBuffer","UNIFORM","TRANSFER_DST","HOST","DEVICE","SIZE","data","info","dirty","_setAnimInfoDirty","key","convertVal","Object","defineProperty","Uint32Array","fill","enumerable","switchClip"],"mappings":"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"}
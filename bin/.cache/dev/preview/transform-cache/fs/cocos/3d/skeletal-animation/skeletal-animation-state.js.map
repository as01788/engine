{"version":3,"sources":["../../../../../../../../../cocos/3d/skeletal-animation/skeletal-animation-state.ts"],"names":["JSB","SkinnedMeshRenderer","Mat4","Quat","Vec3","AnimationState","SkelAnimDataHub","legacyCC","m4_1","m4_2","SkeletalAnimationState","clip","name","_frames","_bakedDuration","_animInfo","_sockets","_animInfoMgr","_comps","_parent","_curvesInited","director","root","dataPoolManager","jointAnimationInfo","initialize","_curveLoaded","length","comps","getComponentsInChildren","i","comp","skinningRoot","push","getComponent","baked","useBakedAnimation","_doNotCreateEval","getOrExtract","frames","samples","getData","uuid","onPlay","_sampleCurves","_sampleCurvesBaked","duration","switchClip","uploadAnimation","_targetNode","rebuildSocketCurves","sockets","socket","targetNode","getChildByPath","path","target","clipData","animPath","source","joints","animNode","downstream","idx","lastIndexOf","substring","identity","fromRTS","rotation","position","scale","multiply","parent","curveData","transforms","f","mat","tfm","pos","rot","toRTS","_setAnimInfoDirty","info","value","dirty","key","fill","time","ratio","curFrame","data","setRTS"],"mappings":"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"}
{"version":3,"sources":["../../../../../../../../../cocos/particle/renderer/particle-system-renderer-gpu.ts"],"names":["EDITOR","builtinResMgr","AttributeName","Format","Attribute","Mat4","Vec2","Vec4","Quat","Vec3","MaterialInstance","AlignmentSpace","RenderMode","Space","Particle","packGradientRange","Pass","packCurveRangeXYZ","packCurveRangeZ","packCurveRangeXYZW","packCurveRangeN","packCurveRangeXY","ParticleSystemRendererBase","_tempWorldTrans","_tempVec4","_world_rot","_node_rot","_node_euler","_sample_num","_sample_interval","CC_USE_WORLD_SPACE","CC_RENDER_MODE","RENDER_MODE_BILLBOARD","RENDER_MODE_STRETCHED_BILLBOARD","RENDER_MODE_HORIZONTAL_BILLBOARD","RENDER_MODE_VERTICAL_BILLBOARD","RENDER_MODE_MESH","COLOR_OVER_TIME_MODULE_ENABLE","ROTATION_OVER_TIME_MODULE_ENABLE","SIZE_OVER_TIME_MODULE_ENABLE","VELOCITY_OVER_TIME_MODULE_ENABLE","FORCE_OVER_TIME_MODULE_ENABLE","TEXTURE_ANIMATION_MODULE_ENABLE","_vert_attr_name","POSITION_STARTTIME","VERT_SIZE_UV","VERT_ROTATION_UV","COLOR","DIR_LIFE","RANDOM_SEED","_gpu_vert_attr","RGBA32F","R32F","_gpu_vert_attr_mesh","ATTR_TEX_COORD","RGB32F","ATTR_TEX_COORD3","ATTR_NORMAL","ATTR_COLOR1","RGBA8","_matInsInfo","parent","owner","subModelIdx","ParticleSystemRendererGPU","info","_defines","_frameTile_velLenScale","_unifrom_velLenScale","_tmp_velLenScale","_node_scale","_vertAttrs","_defaultMat","_particleNum","_tempParticle","_colorTexture","_forceTexture","_velocityTexture","_rotationTexture","_sizeTexture","_animTexture","_uTimeHandle","_uRotHandle","_uNodeRotHandle","_alignSpace","View","_inited","clone","CC_USE_BILLBOARD","CC_USE_STRETCHED_BILLBOARD","CC_USE_HORIZONTAL_BILLBOARD","CC_USE_VERTICAL_BILLBOARD","onInit","ps","_setVertexAttrib","_initModel","updateMaterialParams","setVertexAttributes","updateRenderMode","_model","constructAttributeIndex","clear","updateRenderData","onDestroy","destroy","enableModule","name","val","pm","mat","_particleSystem","getMaterialInstance","initShaderUniform","recompileShaders","setSubModelMaterial","getFreeParticle","_capacity","setNewParticle","p","addGPUParticleVertexData","_time","updateRotation","pass","passes","doUpdateRotation","Local","node","getRotation","World","getWorldRotation","set","cameraLst","scene","renderScene","cameras","undefined","i","length","camera","checkCamera","visibility","layer","fromViewUp","forward","setUniform","updateScale","doUpdateScale","scaleSpace","getScale","getWorldScale","getHandle","updateParticles","dt","getWorldMatrix","updateGPUParticles","updateShaderUniform","enabled","beforeRender","updateIA","updateAlignSpace","space","x","y","enable","forceModule","_forceOvertimeModule","z","handle","binding","getBindingFromHandle","bindSampler","getGFXSampler","bindTexture","getGFXTexture","spaceHandle","modeHandle","height","velocityModule","_velocityOvertimeModule","speedModifier","colorModule","_colorOverLifetimeModule","color","roationModule","_rotationOvertimeModule","separateAxes","sizeModule","_sizeOvertimeModule","size","textureModule","_textureAnimationModule","startFrame","frameOverTime","infoHandle","numTilesX","numTilesY","cycleCount","getParticleCount","onMaterialModified","index","material","onRebuildPSO","_renderInfo","renderMode","StrecthedBillboard","slice","Mesh","shareMaterial","sharedMaterial","effectName","_effectAsset","_name","mainTexture","getProperty","indexOf","setMaterial","get","setProperty","_simulationSpace","Billboard","velocityScale","w","lengthScale","HorizontalBillboard","VerticalBillboard","console","warn","copy","updateMaterial"],"mappings":"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"}